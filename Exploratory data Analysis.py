{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "945baa94-0b6c-414a-b2a4-d5ae856aec65",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd \n",
    "import sqlite3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "300518fb-85ad-4b3e-8c18-f53434ec0687",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('vendor_invoice',), ('inventory',), ('begin_inventory',), ('end_inventory',), ('purchases',), ('purchase_prices',), ('sales',), ('vendor_sales_summary',)]\n"
     ]
    }
   ],
   "source": [
    "import sqlite3\n",
    "\n",
    "conn = sqlite3.connect('inventory.db')\n",
    "cursor = conn.cursor()\n",
    "\n",
    "cursor.execute(\"SELECT name FROM sqlite_master WHERE type='table';\")\n",
    "print(cursor.fetchall())\n",
    "\n",
    "conn.close()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c0cf6104-22b3-49e5-98ad-fd9bad35ca3b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>vendor_invoice</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>inventory</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>begin_inventory</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>end_inventory</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>purchases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>purchase_prices</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>sales</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>vendor_sales_summary</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   name\n",
       "0        vendor_invoice\n",
       "1             inventory\n",
       "2       begin_inventory\n",
       "3         end_inventory\n",
       "4             purchases\n",
       "5       purchase_prices\n",
       "6                 sales\n",
       "7  vendor_sales_summary"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "\n",
    "conn = sqlite3.connect('inventory.db')\n",
    "\n",
    "tables = pd.read_sql_query(\n",
    "    \"SELECT name FROM sqlite_master WHERE type='table';\",\n",
    "    conn\n",
    ")\n",
    "\n",
    "tables\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "2dabf61b-e380-4a6f-af45-3eaf36b7f717",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<function pandas.io.sql.read_sql(sql, con, index_col: 'str | list[str] | None' = None, coerce_float: 'bool' = True, params=None, parse_dates=None, columns: 'list[str] | None' = None, chunksize: 'int | None' = None, dtype_backend: 'DtypeBackend | lib.NoDefault' = <no_default>, dtype: 'DtypeArg | None' = None) -> 'DataFrame | Iterator[DataFrame]'>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.read_sql"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "b2626bd4-0ed1-43f9-be5f-9b985fec2360",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-------------------------------------------------- vendor_invoice --------------------------------------------------\n",
      "count of records: 22172\n",
      "-------------------------------------------------- inventory --------------------------------------------------\n",
      "count of records: 5543\n",
      "-------------------------------------------------- begin_inventory --------------------------------------------------\n",
      "count of records: 206529\n",
      "-------------------------------------------------- end_inventory --------------------------------------------------\n",
      "count of records: 224489\n",
      "-------------------------------------------------- purchases --------------------------------------------------\n",
      "count of records: 2372474\n",
      "-------------------------------------------------- purchase_prices --------------------------------------------------\n",
      "count of records: 12261\n",
      "-------------------------------------------------- sales --------------------------------------------------\n",
      "count of records: 2052150\n",
      "-------------------------------------------------- vendor_sales_summary --------------------------------------------------\n",
      "count of records: 10698\n"
     ]
    }
   ],
   "source": [
    "for table in tables['name']:\n",
    "    print('-'*50,f'{table}','-'*50)\n",
    "    print('count of records:' , pd.read_sql(f\"select count(*) as count from {table}\" , conn) ['count'].values[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "b6a68ec2-299b-43f8-8507-c2c9a8500123",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-------------------------------------------------- vendor_invoice --------------------------------------------------\n",
      "count of records: 22172\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>InvoiceDate</th>\n",
       "      <th>PONumber</th>\n",
       "      <th>PODate</th>\n",
       "      <th>PayDate</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Dollars</th>\n",
       "      <th>Freight</th>\n",
       "      <th>Approval</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>105</td>\n",
       "      <td>ALTAMAR BRANDS LLC</td>\n",
       "      <td>2024-01-04</td>\n",
       "      <td>8124</td>\n",
       "      <td>2023-12-21</td>\n",
       "      <td>2024-02-16</td>\n",
       "      <td>6</td>\n",
       "      <td>214.26</td>\n",
       "      <td>3.47</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>15</td>\n",
       "      <td>140.55</td>\n",
       "      <td>8.57</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>388</td>\n",
       "      <td>ATLANTIC IMPORTING COMPANY</td>\n",
       "      <td>2024-01-09</td>\n",
       "      <td>8169</td>\n",
       "      <td>2023-12-24</td>\n",
       "      <td>2024-02-16</td>\n",
       "      <td>5</td>\n",
       "      <td>106.60</td>\n",
       "      <td>4.61</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>480</td>\n",
       "      <td>BACARDI USA INC</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>8106</td>\n",
       "      <td>2023-12-20</td>\n",
       "      <td>2024-02-05</td>\n",
       "      <td>10100</td>\n",
       "      <td>137483.78</td>\n",
       "      <td>2935.20</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>516</td>\n",
       "      <td>BANFI PRODUCTS CORP</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>8170</td>\n",
       "      <td>2023-12-24</td>\n",
       "      <td>2024-02-12</td>\n",
       "      <td>1935</td>\n",
       "      <td>15527.25</td>\n",
       "      <td>429.20</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   VendorNumber                   VendorName InvoiceDate  PONumber  \\\n",
       "0           105  ALTAMAR BRANDS LLC           2024-01-04      8124   \n",
       "1          4466  AMERICAN VINTAGE BEVERAGE    2024-01-07      8137   \n",
       "2           388  ATLANTIC IMPORTING COMPANY   2024-01-09      8169   \n",
       "3           480  BACARDI USA INC              2024-01-12      8106   \n",
       "4           516  BANFI PRODUCTS CORP          2024-01-07      8170   \n",
       "\n",
       "       PODate     PayDate  Quantity    Dollars  Freight Approval  \n",
       "0  2023-12-21  2024-02-16         6     214.26     3.47     None  \n",
       "1  2023-12-22  2024-02-21        15     140.55     8.57     None  \n",
       "2  2023-12-24  2024-02-16         5     106.60     4.61     None  \n",
       "3  2023-12-20  2024-02-05     10100  137483.78  2935.20     None  \n",
       "4  2023-12-24  2024-02-12      1935   15527.25   429.20     None  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-------------------------------------------------- inventory --------------------------------------------------\n",
      "count of records: 5543\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>InvoiceDate</th>\n",
       "      <th>PONumber</th>\n",
       "      <th>PODate</th>\n",
       "      <th>PayDate</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Dollars</th>\n",
       "      <th>Freight</th>\n",
       "      <th>Approval</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>105</td>\n",
       "      <td>ALTAMAR BRANDS LLC</td>\n",
       "      <td>2024-01-04</td>\n",
       "      <td>8124</td>\n",
       "      <td>2023-12-21</td>\n",
       "      <td>2024-02-16</td>\n",
       "      <td>6</td>\n",
       "      <td>214.26</td>\n",
       "      <td>3.47</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>15</td>\n",
       "      <td>140.55</td>\n",
       "      <td>8.57</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>388</td>\n",
       "      <td>ATLANTIC IMPORTING COMPANY</td>\n",
       "      <td>2024-01-09</td>\n",
       "      <td>8169</td>\n",
       "      <td>2023-12-24</td>\n",
       "      <td>2024-02-16</td>\n",
       "      <td>5</td>\n",
       "      <td>106.60</td>\n",
       "      <td>4.61</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>480</td>\n",
       "      <td>BACARDI USA INC</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>8106</td>\n",
       "      <td>2023-12-20</td>\n",
       "      <td>2024-02-05</td>\n",
       "      <td>10100</td>\n",
       "      <td>137483.78</td>\n",
       "      <td>2935.20</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>516</td>\n",
       "      <td>BANFI PRODUCTS CORP</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>8170</td>\n",
       "      <td>2023-12-24</td>\n",
       "      <td>2024-02-12</td>\n",
       "      <td>1935</td>\n",
       "      <td>15527.25</td>\n",
       "      <td>429.20</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   VendorNumber                   VendorName InvoiceDate  PONumber  \\\n",
       "0           105  ALTAMAR BRANDS LLC           2024-01-04      8124   \n",
       "1          4466  AMERICAN VINTAGE BEVERAGE    2024-01-07      8137   \n",
       "2           388  ATLANTIC IMPORTING COMPANY   2024-01-09      8169   \n",
       "3           480  BACARDI USA INC              2024-01-12      8106   \n",
       "4           516  BANFI PRODUCTS CORP          2024-01-07      8170   \n",
       "\n",
       "       PODate     PayDate  Quantity    Dollars  Freight Approval  \n",
       "0  2023-12-21  2024-02-16         6     214.26     3.47     None  \n",
       "1  2023-12-22  2024-02-21        15     140.55     8.57     None  \n",
       "2  2023-12-24  2024-02-16         5     106.60     4.61     None  \n",
       "3  2023-12-20  2024-02-05     10100  137483.78  2935.20     None  \n",
       "4  2023-12-24  2024-02-12      1935   15527.25   429.20     None  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-------------------------------------------------- begin_inventory --------------------------------------------------\n",
      "count of records: 206529\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>InventoryId</th>\n",
       "      <th>Store</th>\n",
       "      <th>City</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Size</th>\n",
       "      <th>onHand</th>\n",
       "      <th>Price</th>\n",
       "      <th>startDate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1_HARDERSFIELD_58</td>\n",
       "      <td>1</td>\n",
       "      <td>HARDERSFIELD</td>\n",
       "      <td>58</td>\n",
       "      <td>Gekkeikan Black &amp; Gold Sake</td>\n",
       "      <td>750mL</td>\n",
       "      <td>8</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1_HARDERSFIELD_60</td>\n",
       "      <td>1</td>\n",
       "      <td>HARDERSFIELD</td>\n",
       "      <td>60</td>\n",
       "      <td>Canadian Club 1858 VAP</td>\n",
       "      <td>750mL</td>\n",
       "      <td>7</td>\n",
       "      <td>10.99</td>\n",
       "      <td>2024-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1_HARDERSFIELD_62</td>\n",
       "      <td>1</td>\n",
       "      <td>HARDERSFIELD</td>\n",
       "      <td>62</td>\n",
       "      <td>Herradura Silver Tequila</td>\n",
       "      <td>750mL</td>\n",
       "      <td>6</td>\n",
       "      <td>36.99</td>\n",
       "      <td>2024-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1_HARDERSFIELD_63</td>\n",
       "      <td>1</td>\n",
       "      <td>HARDERSFIELD</td>\n",
       "      <td>63</td>\n",
       "      <td>Herradura Reposado Tequila</td>\n",
       "      <td>750mL</td>\n",
       "      <td>3</td>\n",
       "      <td>38.99</td>\n",
       "      <td>2024-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1_HARDERSFIELD_72</td>\n",
       "      <td>1</td>\n",
       "      <td>HARDERSFIELD</td>\n",
       "      <td>72</td>\n",
       "      <td>No. 3 London Dry Gin</td>\n",
       "      <td>750mL</td>\n",
       "      <td>6</td>\n",
       "      <td>34.99</td>\n",
       "      <td>2024-01-01</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         InventoryId  Store          City  Brand                  Description  \\\n",
       "0  1_HARDERSFIELD_58      1  HARDERSFIELD     58  Gekkeikan Black & Gold Sake   \n",
       "1  1_HARDERSFIELD_60      1  HARDERSFIELD     60       Canadian Club 1858 VAP   \n",
       "2  1_HARDERSFIELD_62      1  HARDERSFIELD     62     Herradura Silver Tequila   \n",
       "3  1_HARDERSFIELD_63      1  HARDERSFIELD     63   Herradura Reposado Tequila   \n",
       "4  1_HARDERSFIELD_72      1  HARDERSFIELD     72         No. 3 London Dry Gin   \n",
       "\n",
       "    Size  onHand  Price   startDate  \n",
       "0  750mL       8  12.99  2024-01-01  \n",
       "1  750mL       7  10.99  2024-01-01  \n",
       "2  750mL       6  36.99  2024-01-01  \n",
       "3  750mL       3  38.99  2024-01-01  \n",
       "4  750mL       6  34.99  2024-01-01  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-------------------------------------------------- end_inventory --------------------------------------------------\n",
      "count of records: 224489\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>InventoryId</th>\n",
       "      <th>Store</th>\n",
       "      <th>City</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Size</th>\n",
       "      <th>onHand</th>\n",
       "      <th>Price</th>\n",
       "      <th>endDate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1_HARDERSFIELD_58</td>\n",
       "      <td>1</td>\n",
       "      <td>HARDERSFIELD</td>\n",
       "      <td>58</td>\n",
       "      <td>Gekkeikan Black &amp; Gold Sake</td>\n",
       "      <td>750mL</td>\n",
       "      <td>11</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-12-31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1_HARDERSFIELD_62</td>\n",
       "      <td>1</td>\n",
       "      <td>HARDERSFIELD</td>\n",
       "      <td>62</td>\n",
       "      <td>Herradura Silver Tequila</td>\n",
       "      <td>750mL</td>\n",
       "      <td>7</td>\n",
       "      <td>36.99</td>\n",
       "      <td>2024-12-31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1_HARDERSFIELD_63</td>\n",
       "      <td>1</td>\n",
       "      <td>HARDERSFIELD</td>\n",
       "      <td>63</td>\n",
       "      <td>Herradura Reposado Tequila</td>\n",
       "      <td>750mL</td>\n",
       "      <td>7</td>\n",
       "      <td>38.99</td>\n",
       "      <td>2024-12-31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1_HARDERSFIELD_72</td>\n",
       "      <td>1</td>\n",
       "      <td>HARDERSFIELD</td>\n",
       "      <td>72</td>\n",
       "      <td>No. 3 London Dry Gin</td>\n",
       "      <td>750mL</td>\n",
       "      <td>4</td>\n",
       "      <td>34.99</td>\n",
       "      <td>2024-12-31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1_HARDERSFIELD_75</td>\n",
       "      <td>1</td>\n",
       "      <td>HARDERSFIELD</td>\n",
       "      <td>75</td>\n",
       "      <td>Three Olives Tomato Vodka</td>\n",
       "      <td>750mL</td>\n",
       "      <td>7</td>\n",
       "      <td>14.99</td>\n",
       "      <td>2024-12-31</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         InventoryId  Store          City  Brand                  Description  \\\n",
       "0  1_HARDERSFIELD_58      1  HARDERSFIELD     58  Gekkeikan Black & Gold Sake   \n",
       "1  1_HARDERSFIELD_62      1  HARDERSFIELD     62     Herradura Silver Tequila   \n",
       "2  1_HARDERSFIELD_63      1  HARDERSFIELD     63   Herradura Reposado Tequila   \n",
       "3  1_HARDERSFIELD_72      1  HARDERSFIELD     72         No. 3 London Dry Gin   \n",
       "4  1_HARDERSFIELD_75      1  HARDERSFIELD     75    Three Olives Tomato Vodka   \n",
       "\n",
       "    Size  onHand  Price     endDate  \n",
       "0  750mL      11  12.99  2024-12-31  \n",
       "1  750mL       7  36.99  2024-12-31  \n",
       "2  750mL       7  38.99  2024-12-31  \n",
       "3  750mL       4  34.99  2024-12-31  \n",
       "4  750mL       7  14.99  2024-12-31  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-------------------------------------------------- purchases --------------------------------------------------\n",
      "count of records: 2372474\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>InventoryId</th>\n",
       "      <th>Store</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Size</th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>PONumber</th>\n",
       "      <th>PODate</th>\n",
       "      <th>ReceivingDate</th>\n",
       "      <th>InvoiceDate</th>\n",
       "      <th>PayDate</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Dollars</th>\n",
       "      <th>Classification</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>69_MOUNTMEND_8412</td>\n",
       "      <td>69</td>\n",
       "      <td>8412</td>\n",
       "      <td>Tequila Ocho Plata Fresno</td>\n",
       "      <td>750mL</td>\n",
       "      <td>105</td>\n",
       "      <td>ALTAMAR BRANDS LLC</td>\n",
       "      <td>8124</td>\n",
       "      <td>2023-12-21</td>\n",
       "      <td>2024-01-02</td>\n",
       "      <td>2024-01-04</td>\n",
       "      <td>2024-02-16</td>\n",
       "      <td>35.71</td>\n",
       "      <td>6</td>\n",
       "      <td>214.26</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>30_CULCHETH_5255</td>\n",
       "      <td>30</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-01-01</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>9.35</td>\n",
       "      <td>4</td>\n",
       "      <td>37.40</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>34_PITMERDEN_5215</td>\n",
       "      <td>34</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-01-02</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>9.41</td>\n",
       "      <td>5</td>\n",
       "      <td>47.05</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1_HARDERSFIELD_5255</td>\n",
       "      <td>1</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-01-01</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>9.35</td>\n",
       "      <td>6</td>\n",
       "      <td>56.10</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>76_DONCASTER_2034</td>\n",
       "      <td>76</td>\n",
       "      <td>2034</td>\n",
       "      <td>Glendalough Double Barrel</td>\n",
       "      <td>750mL</td>\n",
       "      <td>388</td>\n",
       "      <td>ATLANTIC IMPORTING COMPANY</td>\n",
       "      <td>8169</td>\n",
       "      <td>2023-12-24</td>\n",
       "      <td>2024-01-02</td>\n",
       "      <td>2024-01-09</td>\n",
       "      <td>2024-02-16</td>\n",
       "      <td>21.32</td>\n",
       "      <td>5</td>\n",
       "      <td>106.60</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           InventoryId  Store  Brand                   Description   Size  \\\n",
       "0    69_MOUNTMEND_8412     69   8412     Tequila Ocho Plata Fresno  750mL   \n",
       "1     30_CULCHETH_5255     30   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "2    34_PITMERDEN_5215     34   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "3  1_HARDERSFIELD_5255      1   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "4    76_DONCASTER_2034     76   2034     Glendalough Double Barrel  750mL   \n",
       "\n",
       "   VendorNumber                   VendorName  PONumber      PODate  \\\n",
       "0           105  ALTAMAR BRANDS LLC               8124  2023-12-21   \n",
       "1          4466  AMERICAN VINTAGE BEVERAGE        8137  2023-12-22   \n",
       "2          4466  AMERICAN VINTAGE BEVERAGE        8137  2023-12-22   \n",
       "3          4466  AMERICAN VINTAGE BEVERAGE        8137  2023-12-22   \n",
       "4           388  ATLANTIC IMPORTING COMPANY       8169  2023-12-24   \n",
       "\n",
       "  ReceivingDate InvoiceDate     PayDate  PurchasePrice  Quantity  Dollars  \\\n",
       "0    2024-01-02  2024-01-04  2024-02-16          35.71         6   214.26   \n",
       "1    2024-01-01  2024-01-07  2024-02-21           9.35         4    37.40   \n",
       "2    2024-01-02  2024-01-07  2024-02-21           9.41         5    47.05   \n",
       "3    2024-01-01  2024-01-07  2024-02-21           9.35         6    56.10   \n",
       "4    2024-01-02  2024-01-09  2024-02-16          21.32         5   106.60   \n",
       "\n",
       "   Classification  \n",
       "0               1  \n",
       "1               1  \n",
       "2               1  \n",
       "3               1  \n",
       "4               1  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-------------------------------------------------- purchase_prices --------------------------------------------------\n",
      "count of records: 12261\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Price</th>\n",
       "      <th>Size</th>\n",
       "      <th>Volume</th>\n",
       "      <th>Classification</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>58</td>\n",
       "      <td>Gekkeikan Black &amp; Gold Sake</td>\n",
       "      <td>12.99</td>\n",
       "      <td>750mL</td>\n",
       "      <td>750</td>\n",
       "      <td>1</td>\n",
       "      <td>9.28</td>\n",
       "      <td>8320</td>\n",
       "      <td>SHAW ROSS INT L IMP LTD</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>62</td>\n",
       "      <td>Herradura Silver Tequila</td>\n",
       "      <td>36.99</td>\n",
       "      <td>750mL</td>\n",
       "      <td>750</td>\n",
       "      <td>1</td>\n",
       "      <td>28.67</td>\n",
       "      <td>1128</td>\n",
       "      <td>BROWN-FORMAN CORP</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>63</td>\n",
       "      <td>Herradura Reposado Tequila</td>\n",
       "      <td>38.99</td>\n",
       "      <td>750mL</td>\n",
       "      <td>750</td>\n",
       "      <td>1</td>\n",
       "      <td>30.46</td>\n",
       "      <td>1128</td>\n",
       "      <td>BROWN-FORMAN CORP</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>72</td>\n",
       "      <td>No. 3 London Dry Gin</td>\n",
       "      <td>34.99</td>\n",
       "      <td>750mL</td>\n",
       "      <td>750</td>\n",
       "      <td>1</td>\n",
       "      <td>26.11</td>\n",
       "      <td>9165</td>\n",
       "      <td>ULTRA BEVERAGE COMPANY LLP</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>75</td>\n",
       "      <td>Three Olives Tomato Vodka</td>\n",
       "      <td>14.99</td>\n",
       "      <td>750mL</td>\n",
       "      <td>750</td>\n",
       "      <td>1</td>\n",
       "      <td>10.94</td>\n",
       "      <td>7245</td>\n",
       "      <td>PROXIMO SPIRITS INC.</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Brand                  Description  Price   Size  Volume  Classification  \\\n",
       "0     58  Gekkeikan Black & Gold Sake  12.99  750mL     750               1   \n",
       "1     62     Herradura Silver Tequila  36.99  750mL     750               1   \n",
       "2     63   Herradura Reposado Tequila  38.99  750mL     750               1   \n",
       "3     72         No. 3 London Dry Gin  34.99  750mL     750               1   \n",
       "4     75    Three Olives Tomato Vodka  14.99  750mL     750               1   \n",
       "\n",
       "   PurchasePrice  VendorNumber                   VendorName  \n",
       "0           9.28          8320  SHAW ROSS INT L IMP LTD      \n",
       "1          28.67          1128  BROWN-FORMAN CORP            \n",
       "2          30.46          1128  BROWN-FORMAN CORP            \n",
       "3          26.11          9165  ULTRA BEVERAGE COMPANY LLP   \n",
       "4          10.94          7245  PROXIMO SPIRITS INC.         "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-------------------------------------------------- sales --------------------------------------------------\n",
      "count of records: 2052150\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>InventoryId</th>\n",
       "      <th>Store</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Size</th>\n",
       "      <th>SalesQuantity</th>\n",
       "      <th>SalesDollars</th>\n",
       "      <th>SalesPrice</th>\n",
       "      <th>SalesDate</th>\n",
       "      <th>Volume</th>\n",
       "      <th>Classification</th>\n",
       "      <th>ExciseTax</th>\n",
       "      <th>VendorNo</th>\n",
       "      <th>VendorName</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1_HARDERSFIELD_1004</td>\n",
       "      <td>1</td>\n",
       "      <td>1004</td>\n",
       "      <td>Jim Beam w/2 Rocks Glasses</td>\n",
       "      <td>750mL</td>\n",
       "      <td>1</td>\n",
       "      <td>16.49</td>\n",
       "      <td>16.49</td>\n",
       "      <td>2024-01-01</td>\n",
       "      <td>750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.79</td>\n",
       "      <td>12546</td>\n",
       "      <td>JIM BEAM BRANDS COMPANY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1_HARDERSFIELD_1004</td>\n",
       "      <td>1</td>\n",
       "      <td>1004</td>\n",
       "      <td>Jim Beam w/2 Rocks Glasses</td>\n",
       "      <td>750mL</td>\n",
       "      <td>2</td>\n",
       "      <td>32.98</td>\n",
       "      <td>16.49</td>\n",
       "      <td>2024-01-02</td>\n",
       "      <td>750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.57</td>\n",
       "      <td>12546</td>\n",
       "      <td>JIM BEAM BRANDS COMPANY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1_HARDERSFIELD_1004</td>\n",
       "      <td>1</td>\n",
       "      <td>1004</td>\n",
       "      <td>Jim Beam w/2 Rocks Glasses</td>\n",
       "      <td>750mL</td>\n",
       "      <td>1</td>\n",
       "      <td>16.49</td>\n",
       "      <td>16.49</td>\n",
       "      <td>2024-01-03</td>\n",
       "      <td>750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.79</td>\n",
       "      <td>12546</td>\n",
       "      <td>JIM BEAM BRANDS COMPANY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1_HARDERSFIELD_1004</td>\n",
       "      <td>1</td>\n",
       "      <td>1004</td>\n",
       "      <td>Jim Beam w/2 Rocks Glasses</td>\n",
       "      <td>750mL</td>\n",
       "      <td>1</td>\n",
       "      <td>14.49</td>\n",
       "      <td>14.49</td>\n",
       "      <td>2024-01-08</td>\n",
       "      <td>750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.79</td>\n",
       "      <td>12546</td>\n",
       "      <td>JIM BEAM BRANDS COMPANY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1_HARDERSFIELD_1005</td>\n",
       "      <td>1</td>\n",
       "      <td>1005</td>\n",
       "      <td>Maker's Mark Combo Pack</td>\n",
       "      <td>375mL 2 Pk</td>\n",
       "      <td>2</td>\n",
       "      <td>69.98</td>\n",
       "      <td>34.99</td>\n",
       "      <td>2024-01-09</td>\n",
       "      <td>375.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.79</td>\n",
       "      <td>12546</td>\n",
       "      <td>JIM BEAM BRANDS COMPANY</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           InventoryId  Store  Brand                 Description        Size  \\\n",
       "0  1_HARDERSFIELD_1004      1   1004  Jim Beam w/2 Rocks Glasses       750mL   \n",
       "1  1_HARDERSFIELD_1004      1   1004  Jim Beam w/2 Rocks Glasses       750mL   \n",
       "2  1_HARDERSFIELD_1004      1   1004  Jim Beam w/2 Rocks Glasses       750mL   \n",
       "3  1_HARDERSFIELD_1004      1   1004  Jim Beam w/2 Rocks Glasses       750mL   \n",
       "4  1_HARDERSFIELD_1005      1   1005     Maker's Mark Combo Pack  375mL 2 Pk   \n",
       "\n",
       "   SalesQuantity  SalesDollars  SalesPrice   SalesDate  Volume  \\\n",
       "0              1         16.49       16.49  2024-01-01   750.0   \n",
       "1              2         32.98       16.49  2024-01-02   750.0   \n",
       "2              1         16.49       16.49  2024-01-03   750.0   \n",
       "3              1         14.49       14.49  2024-01-08   750.0   \n",
       "4              2         69.98       34.99  2024-01-09   375.0   \n",
       "\n",
       "   Classification  ExciseTax  VendorNo                   VendorName  \n",
       "0               1       0.79     12546  JIM BEAM BRANDS COMPANY      \n",
       "1               1       1.57     12546  JIM BEAM BRANDS COMPANY      \n",
       "2               1       0.79     12546  JIM BEAM BRANDS COMPANY      \n",
       "3               1       0.79     12546  JIM BEAM BRANDS COMPANY      \n",
       "4               1       0.79     12546  JIM BEAM BRANDS COMPANY      "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-------------------------------------------------- vendor_sales_summary --------------------------------------------------\n",
      "count of records: 10698\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Volume</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>ActualPrice</th>\n",
       "      <th>TotalPurchaseQuantity</th>\n",
       "      <th>TotalPurchaseDollars</th>\n",
       "      <th>TotalSalesQuantity</th>\n",
       "      <th>TotalSalesDollars</th>\n",
       "      <th>TotalSalesPrice</th>\n",
       "      <th>TotalExciseTax</th>\n",
       "      <th>FreightCost</th>\n",
       "      <th>Profit</th>\n",
       "      <th>GrossProfit</th>\n",
       "      <th>ProfitMargin</th>\n",
       "      <th>StockTurnover</th>\n",
       "      <th>SalesToPurchaseRatio</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>90037</td>\n",
       "      <td>THE PIERPONT GROUP LLC</td>\n",
       "      <td>2163</td>\n",
       "      <td>Sloane's Gin</td>\n",
       "      <td>750.0</td>\n",
       "      <td>14.38</td>\n",
       "      <td>20.598696</td>\n",
       "      <td>91</td>\n",
       "      <td>1308.58</td>\n",
       "      <td>174.0</td>\n",
       "      <td>3553.26</td>\n",
       "      <td>2368.85</td>\n",
       "      <td>137.18</td>\n",
       "      <td>111.92</td>\n",
       "      <td>2132.76</td>\n",
       "      <td>2244.68</td>\n",
       "      <td>63.172411</td>\n",
       "      <td>1.912088</td>\n",
       "      <td>2.715356</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2396</td>\n",
       "      <td>BLACK PRINCE DISTILLERY INC</td>\n",
       "      <td>3079</td>\n",
       "      <td>Devils Spring Vodka</td>\n",
       "      <td>750.0</td>\n",
       "      <td>10.21</td>\n",
       "      <td>14.098527</td>\n",
       "      <td>420</td>\n",
       "      <td>4288.20</td>\n",
       "      <td>456.0</td>\n",
       "      <td>6231.44</td>\n",
       "      <td>3637.42</td>\n",
       "      <td>359.25</td>\n",
       "      <td>123.92</td>\n",
       "      <td>1819.32</td>\n",
       "      <td>1943.24</td>\n",
       "      <td>31.184445</td>\n",
       "      <td>1.085714</td>\n",
       "      <td>1.453160</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>90047</td>\n",
       "      <td>CRUSH WINES</td>\n",
       "      <td>23218</td>\n",
       "      <td>Tangent Chard</td>\n",
       "      <td>750.0</td>\n",
       "      <td>6.70</td>\n",
       "      <td>9.990000</td>\n",
       "      <td>663</td>\n",
       "      <td>4442.10</td>\n",
       "      <td>1154.0</td>\n",
       "      <td>11528.46</td>\n",
       "      <td>5344.65</td>\n",
       "      <td>128.60</td>\n",
       "      <td>5830.92</td>\n",
       "      <td>1255.44</td>\n",
       "      <td>7086.36</td>\n",
       "      <td>61.468401</td>\n",
       "      <td>1.740573</td>\n",
       "      <td>2.595273</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>90037</td>\n",
       "      <td>THE PIERPONT GROUP LLC</td>\n",
       "      <td>3770</td>\n",
       "      <td>Miodula Honey Vodka</td>\n",
       "      <td>750.0</td>\n",
       "      <td>14.17</td>\n",
       "      <td>19.546962</td>\n",
       "      <td>142</td>\n",
       "      <td>2012.14</td>\n",
       "      <td>141.0</td>\n",
       "      <td>2729.59</td>\n",
       "      <td>1544.21</td>\n",
       "      <td>111.11</td>\n",
       "      <td>111.92</td>\n",
       "      <td>605.53</td>\n",
       "      <td>717.45</td>\n",
       "      <td>26.284167</td>\n",
       "      <td>0.992958</td>\n",
       "      <td>1.356561</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2555</td>\n",
       "      <td>DISARONNO INTERNATIONAL LLC</td>\n",
       "      <td>1212</td>\n",
       "      <td>DiSaronna Amaretto Sour VAP</td>\n",
       "      <td>750.0</td>\n",
       "      <td>14.38</td>\n",
       "      <td>21.872521</td>\n",
       "      <td>563</td>\n",
       "      <td>8095.94</td>\n",
       "      <td>1467.0</td>\n",
       "      <td>32089.33</td>\n",
       "      <td>15267.02</td>\n",
       "      <td>1155.39</td>\n",
       "      <td>23444.12</td>\n",
       "      <td>549.27</td>\n",
       "      <td>23993.39</td>\n",
       "      <td>74.770617</td>\n",
       "      <td>2.605684</td>\n",
       "      <td>3.963632</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   VendorNumber                   VendorName  Brand  \\\n",
       "0         90037  THE PIERPONT GROUP LLC        2163   \n",
       "1          2396  BLACK PRINCE DISTILLERY INC   3079   \n",
       "2         90047  CRUSH WINES                  23218   \n",
       "3         90037  THE PIERPONT GROUP LLC        3770   \n",
       "4          2555  DISARONNO INTERNATIONAL LLC   1212   \n",
       "\n",
       "                   Description  Volume  PurchasePrice  ActualPrice  \\\n",
       "0                 Sloane's Gin   750.0          14.38    20.598696   \n",
       "1          Devils Spring Vodka   750.0          10.21    14.098527   \n",
       "2                Tangent Chard   750.0           6.70     9.990000   \n",
       "3          Miodula Honey Vodka   750.0          14.17    19.546962   \n",
       "4  DiSaronna Amaretto Sour VAP   750.0          14.38    21.872521   \n",
       "\n",
       "   TotalPurchaseQuantity  TotalPurchaseDollars  TotalSalesQuantity  \\\n",
       "0                     91               1308.58               174.0   \n",
       "1                    420               4288.20               456.0   \n",
       "2                    663               4442.10              1154.0   \n",
       "3                    142               2012.14               141.0   \n",
       "4                    563               8095.94              1467.0   \n",
       "\n",
       "   TotalSalesDollars  TotalSalesPrice  TotalExciseTax  FreightCost   Profit  \\\n",
       "0            3553.26          2368.85          137.18       111.92  2132.76   \n",
       "1            6231.44          3637.42          359.25       123.92  1819.32   \n",
       "2           11528.46          5344.65          128.60      5830.92  1255.44   \n",
       "3            2729.59          1544.21          111.11       111.92   605.53   \n",
       "4           32089.33         15267.02         1155.39     23444.12   549.27   \n",
       "\n",
       "   GrossProfit  ProfitMargin  StockTurnover  SalesToPurchaseRatio  \n",
       "0      2244.68     63.172411       1.912088              2.715356  \n",
       "1      1943.24     31.184445       1.085714              1.453160  \n",
       "2      7086.36     61.468401       1.740573              2.595273  \n",
       "3       717.45     26.284167       0.992958              1.356561  \n",
       "4     23993.39     74.770617       2.605684              3.963632  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "for table in tables['name']:\n",
    "    print('-'*50,f'{table}','-'*50)\n",
    "    print('count of records:' , pd.read_sql(f\"select count(*) as count from {table}\" , conn) ['count'].values[0])\n",
    "    display(pd.read_sql(f\"select * from {table} limit 5\" ,conn))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "8773eadd-1092-4c65-9e01-bd6e213a4ad7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>InventoryId</th>\n",
       "      <th>Store</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Size</th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>PONumber</th>\n",
       "      <th>PODate</th>\n",
       "      <th>ReceivingDate</th>\n",
       "      <th>InvoiceDate</th>\n",
       "      <th>PayDate</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Dollars</th>\n",
       "      <th>Classification</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>30_CULCHETH_5255</td>\n",
       "      <td>30</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-01-01</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>9.35</td>\n",
       "      <td>4</td>\n",
       "      <td>37.40</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>34_PITMERDEN_5215</td>\n",
       "      <td>34</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-01-02</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>9.41</td>\n",
       "      <td>5</td>\n",
       "      <td>47.05</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1_HARDERSFIELD_5255</td>\n",
       "      <td>1</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-01-01</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>9.35</td>\n",
       "      <td>6</td>\n",
       "      <td>56.10</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>38_GOULCREST_5215</td>\n",
       "      <td>38</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8207</td>\n",
       "      <td>2023-12-27</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>2024-01-19</td>\n",
       "      <td>2024-02-26</td>\n",
       "      <td>9.41</td>\n",
       "      <td>6</td>\n",
       "      <td>56.46</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>59_CLAETHORPES_5215</td>\n",
       "      <td>59</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8207</td>\n",
       "      <td>2023-12-27</td>\n",
       "      <td>2024-01-05</td>\n",
       "      <td>2024-01-19</td>\n",
       "      <td>2024-02-26</td>\n",
       "      <td>9.41</td>\n",
       "      <td>6</td>\n",
       "      <td>56.46</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2187</th>\n",
       "      <td>81_PEMBROKE_5215</td>\n",
       "      <td>81</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>13595</td>\n",
       "      <td>2024-12-20</td>\n",
       "      <td>2024-12-29</td>\n",
       "      <td>2025-01-04</td>\n",
       "      <td>2025-02-10</td>\n",
       "      <td>9.41</td>\n",
       "      <td>6</td>\n",
       "      <td>56.46</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2188</th>\n",
       "      <td>62_KILMARNOCK_5255</td>\n",
       "      <td>62</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>13595</td>\n",
       "      <td>2024-12-20</td>\n",
       "      <td>2024-12-28</td>\n",
       "      <td>2025-01-04</td>\n",
       "      <td>2025-02-10</td>\n",
       "      <td>9.35</td>\n",
       "      <td>5</td>\n",
       "      <td>46.75</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2189</th>\n",
       "      <td>34_PITMERDEN_5215</td>\n",
       "      <td>34</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>13595</td>\n",
       "      <td>2024-12-20</td>\n",
       "      <td>2024-12-28</td>\n",
       "      <td>2025-01-04</td>\n",
       "      <td>2025-02-10</td>\n",
       "      <td>9.41</td>\n",
       "      <td>5</td>\n",
       "      <td>47.05</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2190</th>\n",
       "      <td>6_GOULCREST_5215</td>\n",
       "      <td>6</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>13595</td>\n",
       "      <td>2024-12-20</td>\n",
       "      <td>2024-12-31</td>\n",
       "      <td>2025-01-04</td>\n",
       "      <td>2025-02-10</td>\n",
       "      <td>9.41</td>\n",
       "      <td>6</td>\n",
       "      <td>56.46</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2191</th>\n",
       "      <td>35_HALIVAARA_5255</td>\n",
       "      <td>35</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>13595</td>\n",
       "      <td>2024-12-20</td>\n",
       "      <td>2024-12-27</td>\n",
       "      <td>2025-01-04</td>\n",
       "      <td>2025-02-10</td>\n",
       "      <td>9.35</td>\n",
       "      <td>5</td>\n",
       "      <td>46.75</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2192 rows  16 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              InventoryId  Store  Brand                   Description   Size  \\\n",
       "0        30_CULCHETH_5255     30   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "1       34_PITMERDEN_5215     34   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "2     1_HARDERSFIELD_5255      1   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "3       38_GOULCREST_5215     38   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "4     59_CLAETHORPES_5215     59   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "...                   ...    ...    ...                           ...    ...   \n",
       "2187     81_PEMBROKE_5215     81   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "2188   62_KILMARNOCK_5255     62   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "2189    34_PITMERDEN_5215     34   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "2190     6_GOULCREST_5215      6   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "2191    35_HALIVAARA_5255     35   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "\n",
       "      VendorNumber                   VendorName  PONumber      PODate  \\\n",
       "0             4466  AMERICAN VINTAGE BEVERAGE        8137  2023-12-22   \n",
       "1             4466  AMERICAN VINTAGE BEVERAGE        8137  2023-12-22   \n",
       "2             4466  AMERICAN VINTAGE BEVERAGE        8137  2023-12-22   \n",
       "3             4466  AMERICAN VINTAGE BEVERAGE        8207  2023-12-27   \n",
       "4             4466  AMERICAN VINTAGE BEVERAGE        8207  2023-12-27   \n",
       "...            ...                          ...       ...         ...   \n",
       "2187          4466  AMERICAN VINTAGE BEVERAGE       13595  2024-12-20   \n",
       "2188          4466  AMERICAN VINTAGE BEVERAGE       13595  2024-12-20   \n",
       "2189          4466  AMERICAN VINTAGE BEVERAGE       13595  2024-12-20   \n",
       "2190          4466  AMERICAN VINTAGE BEVERAGE       13595  2024-12-20   \n",
       "2191          4466  AMERICAN VINTAGE BEVERAGE       13595  2024-12-20   \n",
       "\n",
       "     ReceivingDate InvoiceDate     PayDate  PurchasePrice  Quantity  Dollars  \\\n",
       "0       2024-01-01  2024-01-07  2024-02-21           9.35         4    37.40   \n",
       "1       2024-01-02  2024-01-07  2024-02-21           9.41         5    47.05   \n",
       "2       2024-01-01  2024-01-07  2024-02-21           9.35         6    56.10   \n",
       "3       2024-01-07  2024-01-19  2024-02-26           9.41         6    56.46   \n",
       "4       2024-01-05  2024-01-19  2024-02-26           9.41         6    56.46   \n",
       "...            ...         ...         ...            ...       ...      ...   \n",
       "2187    2024-12-29  2025-01-04  2025-02-10           9.41         6    56.46   \n",
       "2188    2024-12-28  2025-01-04  2025-02-10           9.35         5    46.75   \n",
       "2189    2024-12-28  2025-01-04  2025-02-10           9.41         5    47.05   \n",
       "2190    2024-12-31  2025-01-04  2025-02-10           9.41         6    56.46   \n",
       "2191    2024-12-27  2025-01-04  2025-02-10           9.35         5    46.75   \n",
       "\n",
       "      Classification  \n",
       "0                  1  \n",
       "1                  1  \n",
       "2                  1  \n",
       "3                  1  \n",
       "4                  1  \n",
       "...              ...  \n",
       "2187               1  \n",
       "2188               1  \n",
       "2189               1  \n",
       "2190               1  \n",
       "2191               1  \n",
       "\n",
       "[2192 rows x 16 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "\n",
    "conn = sqlite3.connect('inventory.db')\n",
    "\n",
    "purchases = pd.read_sql_query(\n",
    "    \"SELECT * FROM purchases WHERE vendorNumber = 4466\",\n",
    "    conn\n",
    ")\n",
    "\n",
    "purchases\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2ca8b46d-d2b8-4423-a5c3-aeb82ab6e45e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Price</th>\n",
       "      <th>Size</th>\n",
       "      <th>Volume</th>\n",
       "      <th>Classification</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>12.99</td>\n",
       "      <td>1750mL</td>\n",
       "      <td>1750</td>\n",
       "      <td>1</td>\n",
       "      <td>9.41</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>12.99</td>\n",
       "      <td>1750mL</td>\n",
       "      <td>1750</td>\n",
       "      <td>1</td>\n",
       "      <td>9.35</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3140</td>\n",
       "      <td>TGI Fridays Orange Dream</td>\n",
       "      <td>14.99</td>\n",
       "      <td>1750mL</td>\n",
       "      <td>1750</td>\n",
       "      <td>1</td>\n",
       "      <td>11.19</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Brand                   Description  Price    Size  Volume  Classification  \\\n",
       "0   5215  TGI Fridays Long Island Iced  12.99  1750mL    1750               1   \n",
       "1   5255  TGI Fridays Ultimte Mudslide  12.99  1750mL    1750               1   \n",
       "2   3140      TGI Fridays Orange Dream  14.99  1750mL    1750               1   \n",
       "\n",
       "   PurchasePrice  VendorNumber                   VendorName  \n",
       "0           9.41          4466  AMERICAN VINTAGE BEVERAGE    \n",
       "1           9.35          4466  AMERICAN VINTAGE BEVERAGE    \n",
       "2          11.19          4466  AMERICAN VINTAGE BEVERAGE    "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "\n",
    "conn = sqlite3.connect(\"inventory.db\")\n",
    "\n",
    "purchases_4466 = pd.read_sql_query(\n",
    "    \"\"\"\n",
    "    SELECT *\n",
    "    FROM purchase_prices\n",
    "    WHERE VendorNumber = 4466\n",
    "    \"\"\",\n",
    "    conn\n",
    ")\n",
    "\n",
    "purchases_4466.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "eee2905e-8b39-4461-9776-8974e33614ef",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>InvoiceDate</th>\n",
       "      <th>PONumber</th>\n",
       "      <th>PODate</th>\n",
       "      <th>PayDate</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Dollars</th>\n",
       "      <th>Freight</th>\n",
       "      <th>Approval</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>15</td>\n",
       "      <td>140.55</td>\n",
       "      <td>8.57</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-01-19</td>\n",
       "      <td>8207</td>\n",
       "      <td>2023-12-27</td>\n",
       "      <td>2024-02-26</td>\n",
       "      <td>335</td>\n",
       "      <td>3142.33</td>\n",
       "      <td>16.97</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-01-18</td>\n",
       "      <td>8307</td>\n",
       "      <td>2024-01-03</td>\n",
       "      <td>2024-02-18</td>\n",
       "      <td>41</td>\n",
       "      <td>383.35</td>\n",
       "      <td>1.99</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-01-27</td>\n",
       "      <td>8469</td>\n",
       "      <td>2024-01-14</td>\n",
       "      <td>2024-03-11</td>\n",
       "      <td>72</td>\n",
       "      <td>673.20</td>\n",
       "      <td>3.30</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-02-04</td>\n",
       "      <td>8532</td>\n",
       "      <td>2024-01-19</td>\n",
       "      <td>2024-03-15</td>\n",
       "      <td>79</td>\n",
       "      <td>740.21</td>\n",
       "      <td>3.48</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>215</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-12-06</td>\n",
       "      <td>13134</td>\n",
       "      <td>2024-11-20</td>\n",
       "      <td>2025-01-18</td>\n",
       "      <td>305</td>\n",
       "      <td>3018.89</td>\n",
       "      <td>15.70</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>216</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-12-16</td>\n",
       "      <td>13254</td>\n",
       "      <td>2024-11-28</td>\n",
       "      <td>2025-01-13</td>\n",
       "      <td>262</td>\n",
       "      <td>2530.36</td>\n",
       "      <td>11.39</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>217</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-12-26</td>\n",
       "      <td>13432</td>\n",
       "      <td>2024-12-09</td>\n",
       "      <td>2025-01-27</td>\n",
       "      <td>231</td>\n",
       "      <td>2263.43</td>\n",
       "      <td>11.32</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>218</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-12-30</td>\n",
       "      <td>13483</td>\n",
       "      <td>2024-12-13</td>\n",
       "      <td>2025-02-11</td>\n",
       "      <td>221</td>\n",
       "      <td>2178.27</td>\n",
       "      <td>11.33</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>219</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2025-01-09</td>\n",
       "      <td>13627</td>\n",
       "      <td>2024-12-22</td>\n",
       "      <td>2025-02-05</td>\n",
       "      <td>413</td>\n",
       "      <td>3985.03</td>\n",
       "      <td>19.53</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>220 rows  10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     VendorNumber                   VendorName InvoiceDate  PONumber  \\\n",
       "0            4466  AMERICAN VINTAGE BEVERAGE    2024-01-07      8137   \n",
       "1            4466  AMERICAN VINTAGE BEVERAGE    2024-01-19      8207   \n",
       "2            4466  AMERICAN VINTAGE BEVERAGE    2024-01-18      8307   \n",
       "3            4466  AMERICAN VINTAGE BEVERAGE    2024-01-27      8469   \n",
       "4            4466  AMERICAN VINTAGE BEVERAGE    2024-02-04      8532   \n",
       "..            ...                          ...         ...       ...   \n",
       "215          4466  AMERICAN VINTAGE BEVERAGE    2024-12-06     13134   \n",
       "216          4466  AMERICAN VINTAGE BEVERAGE    2024-12-16     13254   \n",
       "217          4466  AMERICAN VINTAGE BEVERAGE    2024-12-26     13432   \n",
       "218          4466  AMERICAN VINTAGE BEVERAGE    2024-12-30     13483   \n",
       "219          4466  AMERICAN VINTAGE BEVERAGE    2025-01-09     13627   \n",
       "\n",
       "         PODate     PayDate  Quantity  Dollars  Freight Approval  \n",
       "0    2023-12-22  2024-02-21        15   140.55     8.57     None  \n",
       "1    2023-12-27  2024-02-26       335  3142.33    16.97     None  \n",
       "2    2024-01-03  2024-02-18        41   383.35     1.99     None  \n",
       "3    2024-01-14  2024-03-11        72   673.20     3.30     None  \n",
       "4    2024-01-19  2024-03-15        79   740.21     3.48     None  \n",
       "..          ...         ...       ...      ...      ...      ...  \n",
       "215  2024-11-20  2025-01-18       305  3018.89    15.70     None  \n",
       "216  2024-11-28  2025-01-13       262  2530.36    11.39     None  \n",
       "217  2024-12-09  2025-01-27       231  2263.43    11.32     None  \n",
       "218  2024-12-13  2025-02-11       221  2178.27    11.33     None  \n",
       "219  2024-12-22  2025-02-05       413  3985.03    19.53     None  \n",
       "\n",
       "[220 rows x 10 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_invoice = pd.read_sql_query(\n",
    "    \"SELECT * FROM vendor_invoice Where VendorNumber = 4466;\",\n",
    "    conn\n",
    ")\n",
    "\n",
    "vendor_invoice\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "5d549991-f315-41d0-84bf-fc0901243cc8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>InventoryId</th>\n",
       "      <th>Store</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Size</th>\n",
       "      <th>SalesQuantity</th>\n",
       "      <th>SalesDollars</th>\n",
       "      <th>SalesPrice</th>\n",
       "      <th>SalesDate</th>\n",
       "      <th>Volume</th>\n",
       "      <th>Classification</th>\n",
       "      <th>ExciseTax</th>\n",
       "      <th>VendorNo</th>\n",
       "      <th>VendorName</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10_HORNSEY_5215</td>\n",
       "      <td>10</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>1</td>\n",
       "      <td>12.99</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-01-08</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.84</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10_HORNSEY_5215</td>\n",
       "      <td>10</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>1</td>\n",
       "      <td>12.99</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-01-14</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.84</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10_HORNSEY_5215</td>\n",
       "      <td>10</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>1</td>\n",
       "      <td>12.99</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-01-31</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.84</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10_HORNSEY_5215</td>\n",
       "      <td>10</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>1</td>\n",
       "      <td>12.99</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-02-16</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.84</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10_HORNSEY_5215</td>\n",
       "      <td>10</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>1</td>\n",
       "      <td>12.99</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-03-02</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.84</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>914</th>\n",
       "      <td>8_ALNERWICK_5255</td>\n",
       "      <td>8</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>1</td>\n",
       "      <td>12.99</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-02-13</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.84</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>915</th>\n",
       "      <td>8_ALNERWICK_5255</td>\n",
       "      <td>8</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>2</td>\n",
       "      <td>25.98</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-01-22</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>3.67</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>916</th>\n",
       "      <td>9_BLACKPOOL_5255</td>\n",
       "      <td>9</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>1</td>\n",
       "      <td>12.99</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-02-03</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.84</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>917</th>\n",
       "      <td>9_BLACKPOOL_5255</td>\n",
       "      <td>9</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>1</td>\n",
       "      <td>12.99</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-02-28</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.84</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>918</th>\n",
       "      <td>9_BLACKPOOL_5255</td>\n",
       "      <td>9</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>2</td>\n",
       "      <td>25.98</td>\n",
       "      <td>12.99</td>\n",
       "      <td>2024-01-24</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>3.67</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>919 rows  14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          InventoryId  Store  Brand                   Description   Size  \\\n",
       "0     10_HORNSEY_5215     10   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "1     10_HORNSEY_5215     10   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "2     10_HORNSEY_5215     10   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "3     10_HORNSEY_5215     10   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "4     10_HORNSEY_5215     10   5215  TGI Fridays Long Island Iced  1.75L   \n",
       "..                ...    ...    ...                           ...    ...   \n",
       "914  8_ALNERWICK_5255      8   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "915  8_ALNERWICK_5255      8   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "916  9_BLACKPOOL_5255      9   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "917  9_BLACKPOOL_5255      9   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "918  9_BLACKPOOL_5255      9   5255  TGI Fridays Ultimte Mudslide  1.75L   \n",
       "\n",
       "     SalesQuantity  SalesDollars  SalesPrice   SalesDate  Volume  \\\n",
       "0                1         12.99       12.99  2024-01-08  1750.0   \n",
       "1                1         12.99       12.99  2024-01-14  1750.0   \n",
       "2                1         12.99       12.99  2024-01-31  1750.0   \n",
       "3                1         12.99       12.99  2024-02-16  1750.0   \n",
       "4                1         12.99       12.99  2024-03-02  1750.0   \n",
       "..             ...           ...         ...         ...     ...   \n",
       "914              1         12.99       12.99  2024-02-13  1750.0   \n",
       "915              2         25.98       12.99  2024-01-22  1750.0   \n",
       "916              1         12.99       12.99  2024-02-03  1750.0   \n",
       "917              1         12.99       12.99  2024-02-28  1750.0   \n",
       "918              2         25.98       12.99  2024-01-24  1750.0   \n",
       "\n",
       "     Classification  ExciseTax  VendorNo                   VendorName  \n",
       "0                 1       1.84      4466  AMERICAN VINTAGE BEVERAGE    \n",
       "1                 1       1.84      4466  AMERICAN VINTAGE BEVERAGE    \n",
       "2                 1       1.84      4466  AMERICAN VINTAGE BEVERAGE    \n",
       "3                 1       1.84      4466  AMERICAN VINTAGE BEVERAGE    \n",
       "4                 1       1.84      4466  AMERICAN VINTAGE BEVERAGE    \n",
       "..              ...        ...       ...                          ...  \n",
       "914               1       1.84      4466  AMERICAN VINTAGE BEVERAGE    \n",
       "915               1       3.67      4466  AMERICAN VINTAGE BEVERAGE    \n",
       "916               1       1.84      4466  AMERICAN VINTAGE BEVERAGE    \n",
       "917               1       1.84      4466  AMERICAN VINTAGE BEVERAGE    \n",
       "918               1       3.67      4466  AMERICAN VINTAGE BEVERAGE    \n",
       "\n",
       "[919 rows x 14 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sales_4466 = pd.read_sql_query(\n",
    "    \"\"\"\n",
    "    SELECT \n",
    "        s.*\n",
    "    FROM sales s\n",
    "    JOIN purchase_prices p\n",
    "        ON s.Brand = p.Brand\n",
    "       AND s.Description = p.Description\n",
    "    WHERE p.VendorNumber = 4466\n",
    "    \"\"\",\n",
    "    conn\n",
    ")\n",
    "\n",
    "sales_4466\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "00afe397-858f-4713-a468-ea93fe9d1d9e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>InventoryId</th>\n",
       "      <th>Store</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Size</th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>PONumber</th>\n",
       "      <th>PODate</th>\n",
       "      <th>ReceivingDate</th>\n",
       "      <th>InvoiceDate</th>\n",
       "      <th>PayDate</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Dollars</th>\n",
       "      <th>Classification</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>69_MOUNTMEND_8412</td>\n",
       "      <td>69</td>\n",
       "      <td>8412</td>\n",
       "      <td>Tequila Ocho Plata Fresno</td>\n",
       "      <td>750mL</td>\n",
       "      <td>105</td>\n",
       "      <td>ALTAMAR BRANDS LLC</td>\n",
       "      <td>8124</td>\n",
       "      <td>2023-12-21</td>\n",
       "      <td>2024-01-02</td>\n",
       "      <td>2024-01-04</td>\n",
       "      <td>2024-02-16</td>\n",
       "      <td>35.71</td>\n",
       "      <td>6</td>\n",
       "      <td>214.26</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>30_CULCHETH_5255</td>\n",
       "      <td>30</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-01-01</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>9.35</td>\n",
       "      <td>4</td>\n",
       "      <td>37.40</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>34_PITMERDEN_5215</td>\n",
       "      <td>34</td>\n",
       "      <td>5215</td>\n",
       "      <td>TGI Fridays Long Island Iced</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-01-02</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>9.41</td>\n",
       "      <td>5</td>\n",
       "      <td>47.05</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1_HARDERSFIELD_5255</td>\n",
       "      <td>1</td>\n",
       "      <td>5255</td>\n",
       "      <td>TGI Fridays Ultimte Mudslide</td>\n",
       "      <td>1.75L</td>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-01-01</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>9.35</td>\n",
       "      <td>6</td>\n",
       "      <td>56.10</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>76_DONCASTER_2034</td>\n",
       "      <td>76</td>\n",
       "      <td>2034</td>\n",
       "      <td>Glendalough Double Barrel</td>\n",
       "      <td>750mL</td>\n",
       "      <td>388</td>\n",
       "      <td>ATLANTIC IMPORTING COMPANY</td>\n",
       "      <td>8169</td>\n",
       "      <td>2023-12-24</td>\n",
       "      <td>2024-01-02</td>\n",
       "      <td>2024-01-09</td>\n",
       "      <td>2024-02-16</td>\n",
       "      <td>21.32</td>\n",
       "      <td>5</td>\n",
       "      <td>106.60</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2372469</th>\n",
       "      <td>49_GARIGILL_22298</td>\n",
       "      <td>49</td>\n",
       "      <td>22298</td>\n",
       "      <td>Zorvino Vyds Sangiovese</td>\n",
       "      <td>750mL</td>\n",
       "      <td>90058</td>\n",
       "      <td>ZORVINO VINEYARDS</td>\n",
       "      <td>13593</td>\n",
       "      <td>2024-12-19</td>\n",
       "      <td>2024-12-28</td>\n",
       "      <td>2025-01-09</td>\n",
       "      <td>2025-02-06</td>\n",
       "      <td>8.06</td>\n",
       "      <td>12</td>\n",
       "      <td>96.72</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2372470</th>\n",
       "      <td>1_HARDERSFIELD_19556</td>\n",
       "      <td>1</td>\n",
       "      <td>19556</td>\n",
       "      <td>Zorvino Bacca Z Blackberry</td>\n",
       "      <td>750mL</td>\n",
       "      <td>90058</td>\n",
       "      <td>ZORVINO VINEYARDS</td>\n",
       "      <td>13593</td>\n",
       "      <td>2024-12-19</td>\n",
       "      <td>2024-12-27</td>\n",
       "      <td>2025-01-09</td>\n",
       "      <td>2025-02-06</td>\n",
       "      <td>9.39</td>\n",
       "      <td>12</td>\n",
       "      <td>112.68</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2372471</th>\n",
       "      <td>66_EANVERNESS_22297</td>\n",
       "      <td>66</td>\n",
       "      <td>22297</td>\n",
       "      <td>Zorvino Vyds Pearz</td>\n",
       "      <td>750mL</td>\n",
       "      <td>90058</td>\n",
       "      <td>ZORVINO VINEYARDS</td>\n",
       "      <td>13593</td>\n",
       "      <td>2024-12-19</td>\n",
       "      <td>2024-12-26</td>\n",
       "      <td>2025-01-09</td>\n",
       "      <td>2025-02-06</td>\n",
       "      <td>6.75</td>\n",
       "      <td>12</td>\n",
       "      <td>81.00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2372472</th>\n",
       "      <td>69_MOUNTMEND_19557</td>\n",
       "      <td>69</td>\n",
       "      <td>19557</td>\n",
       "      <td>Zorvino Fragole Z Strawberry</td>\n",
       "      <td>750mL</td>\n",
       "      <td>90058</td>\n",
       "      <td>ZORVINO VINEYARDS</td>\n",
       "      <td>13593</td>\n",
       "      <td>2024-12-19</td>\n",
       "      <td>2024-12-26</td>\n",
       "      <td>2025-01-09</td>\n",
       "      <td>2025-02-06</td>\n",
       "      <td>9.39</td>\n",
       "      <td>12</td>\n",
       "      <td>112.68</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2372473</th>\n",
       "      <td>55_DRY GULCH_22298</td>\n",
       "      <td>55</td>\n",
       "      <td>22298</td>\n",
       "      <td>Zorvino Vyds Sangiovese</td>\n",
       "      <td>750mL</td>\n",
       "      <td>90058</td>\n",
       "      <td>ZORVINO VINEYARDS</td>\n",
       "      <td>13593</td>\n",
       "      <td>2024-12-19</td>\n",
       "      <td>2024-12-28</td>\n",
       "      <td>2025-01-09</td>\n",
       "      <td>2025-02-06</td>\n",
       "      <td>8.06</td>\n",
       "      <td>12</td>\n",
       "      <td>96.72</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2372474 rows  16 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  InventoryId  Store  Brand                   Description  \\\n",
       "0           69_MOUNTMEND_8412     69   8412     Tequila Ocho Plata Fresno   \n",
       "1            30_CULCHETH_5255     30   5255  TGI Fridays Ultimte Mudslide   \n",
       "2           34_PITMERDEN_5215     34   5215  TGI Fridays Long Island Iced   \n",
       "3         1_HARDERSFIELD_5255      1   5255  TGI Fridays Ultimte Mudslide   \n",
       "4           76_DONCASTER_2034     76   2034     Glendalough Double Barrel   \n",
       "...                       ...    ...    ...                           ...   \n",
       "2372469     49_GARIGILL_22298     49  22298       Zorvino Vyds Sangiovese   \n",
       "2372470  1_HARDERSFIELD_19556      1  19556    Zorvino Bacca Z Blackberry   \n",
       "2372471   66_EANVERNESS_22297     66  22297            Zorvino Vyds Pearz   \n",
       "2372472    69_MOUNTMEND_19557     69  19557  Zorvino Fragole Z Strawberry   \n",
       "2372473    55_DRY GULCH_22298     55  22298       Zorvino Vyds Sangiovese   \n",
       "\n",
       "          Size  VendorNumber                   VendorName  PONumber  \\\n",
       "0        750mL           105  ALTAMAR BRANDS LLC               8124   \n",
       "1        1.75L          4466  AMERICAN VINTAGE BEVERAGE        8137   \n",
       "2        1.75L          4466  AMERICAN VINTAGE BEVERAGE        8137   \n",
       "3        1.75L          4466  AMERICAN VINTAGE BEVERAGE        8137   \n",
       "4        750mL           388  ATLANTIC IMPORTING COMPANY       8169   \n",
       "...        ...           ...                          ...       ...   \n",
       "2372469  750mL         90058  ZORVINO VINEYARDS               13593   \n",
       "2372470  750mL         90058  ZORVINO VINEYARDS               13593   \n",
       "2372471  750mL         90058  ZORVINO VINEYARDS               13593   \n",
       "2372472  750mL         90058  ZORVINO VINEYARDS               13593   \n",
       "2372473  750mL         90058  ZORVINO VINEYARDS               13593   \n",
       "\n",
       "             PODate ReceivingDate InvoiceDate     PayDate  PurchasePrice  \\\n",
       "0        2023-12-21    2024-01-02  2024-01-04  2024-02-16          35.71   \n",
       "1        2023-12-22    2024-01-01  2024-01-07  2024-02-21           9.35   \n",
       "2        2023-12-22    2024-01-02  2024-01-07  2024-02-21           9.41   \n",
       "3        2023-12-22    2024-01-01  2024-01-07  2024-02-21           9.35   \n",
       "4        2023-12-24    2024-01-02  2024-01-09  2024-02-16          21.32   \n",
       "...             ...           ...         ...         ...            ...   \n",
       "2372469  2024-12-19    2024-12-28  2025-01-09  2025-02-06           8.06   \n",
       "2372470  2024-12-19    2024-12-27  2025-01-09  2025-02-06           9.39   \n",
       "2372471  2024-12-19    2024-12-26  2025-01-09  2025-02-06           6.75   \n",
       "2372472  2024-12-19    2024-12-26  2025-01-09  2025-02-06           9.39   \n",
       "2372473  2024-12-19    2024-12-28  2025-01-09  2025-02-06           8.06   \n",
       "\n",
       "         Quantity  Dollars  Classification  \n",
       "0               6   214.26               1  \n",
       "1               4    37.40               1  \n",
       "2               5    47.05               1  \n",
       "3               6    56.10               1  \n",
       "4               5   106.60               1  \n",
       "...           ...      ...             ...  \n",
       "2372469        12    96.72               2  \n",
       "2372470        12   112.68               2  \n",
       "2372471        12    81.00               2  \n",
       "2372472        12   112.68               2  \n",
       "2372473        12    96.72               2  \n",
       "\n",
       "[2372474 rows x 16 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "purchases"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "70ef4611-e135-4a2e-a8d1-ef664baf4d99",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "\n",
    "conn = sqlite3.connect(\"inventory.db\")\n",
    "\n",
    "purchases = pd.read_sql_query(\n",
    "    \"SELECT * FROM purchases\",\n",
    "    conn\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "e528e1d3-457f-4336-ad9f-c672ffc06e40",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0          35.71\n",
       "1           9.35\n",
       "2           9.41\n",
       "3           9.35\n",
       "4          21.32\n",
       "           ...  \n",
       "2372469     8.06\n",
       "2372470     9.39\n",
       "2372471     6.75\n",
       "2372472     9.39\n",
       "2372473     8.06\n",
       "Name: PurchasePrice, Length: 2372474, dtype: float64"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "purchases['PurchasePrice']\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "2208fef6-d9e8-4f57-bc93-9e7618d5b7e9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>InvoiceDate</th>\n",
       "      <th>PONumber</th>\n",
       "      <th>PODate</th>\n",
       "      <th>PayDate</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Dollars</th>\n",
       "      <th>Freight</th>\n",
       "      <th>Approval</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-01-07</td>\n",
       "      <td>8137</td>\n",
       "      <td>2023-12-22</td>\n",
       "      <td>2024-02-21</td>\n",
       "      <td>15</td>\n",
       "      <td>140.55</td>\n",
       "      <td>8.57</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-01-19</td>\n",
       "      <td>8207</td>\n",
       "      <td>2023-12-27</td>\n",
       "      <td>2024-02-26</td>\n",
       "      <td>335</td>\n",
       "      <td>3142.33</td>\n",
       "      <td>16.97</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-01-18</td>\n",
       "      <td>8307</td>\n",
       "      <td>2024-01-03</td>\n",
       "      <td>2024-02-18</td>\n",
       "      <td>41</td>\n",
       "      <td>383.35</td>\n",
       "      <td>1.99</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-01-27</td>\n",
       "      <td>8469</td>\n",
       "      <td>2024-01-14</td>\n",
       "      <td>2024-03-11</td>\n",
       "      <td>72</td>\n",
       "      <td>673.20</td>\n",
       "      <td>3.30</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-02-04</td>\n",
       "      <td>8532</td>\n",
       "      <td>2024-01-19</td>\n",
       "      <td>2024-03-15</td>\n",
       "      <td>79</td>\n",
       "      <td>740.21</td>\n",
       "      <td>3.48</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>215</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-12-06</td>\n",
       "      <td>13134</td>\n",
       "      <td>2024-11-20</td>\n",
       "      <td>2025-01-18</td>\n",
       "      <td>305</td>\n",
       "      <td>3018.89</td>\n",
       "      <td>15.70</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>216</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-12-16</td>\n",
       "      <td>13254</td>\n",
       "      <td>2024-11-28</td>\n",
       "      <td>2025-01-13</td>\n",
       "      <td>262</td>\n",
       "      <td>2530.36</td>\n",
       "      <td>11.39</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>217</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-12-26</td>\n",
       "      <td>13432</td>\n",
       "      <td>2024-12-09</td>\n",
       "      <td>2025-01-27</td>\n",
       "      <td>231</td>\n",
       "      <td>2263.43</td>\n",
       "      <td>11.32</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>218</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2024-12-30</td>\n",
       "      <td>13483</td>\n",
       "      <td>2024-12-13</td>\n",
       "      <td>2025-02-11</td>\n",
       "      <td>221</td>\n",
       "      <td>2178.27</td>\n",
       "      <td>11.33</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>219</th>\n",
       "      <td>4466</td>\n",
       "      <td>AMERICAN VINTAGE BEVERAGE</td>\n",
       "      <td>2025-01-09</td>\n",
       "      <td>13627</td>\n",
       "      <td>2024-12-22</td>\n",
       "      <td>2025-02-05</td>\n",
       "      <td>413</td>\n",
       "      <td>3985.03</td>\n",
       "      <td>19.53</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>220 rows  10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     VendorNumber                   VendorName InvoiceDate  PONumber  \\\n",
       "0            4466  AMERICAN VINTAGE BEVERAGE    2024-01-07      8137   \n",
       "1            4466  AMERICAN VINTAGE BEVERAGE    2024-01-19      8207   \n",
       "2            4466  AMERICAN VINTAGE BEVERAGE    2024-01-18      8307   \n",
       "3            4466  AMERICAN VINTAGE BEVERAGE    2024-01-27      8469   \n",
       "4            4466  AMERICAN VINTAGE BEVERAGE    2024-02-04      8532   \n",
       "..            ...                          ...         ...       ...   \n",
       "215          4466  AMERICAN VINTAGE BEVERAGE    2024-12-06     13134   \n",
       "216          4466  AMERICAN VINTAGE BEVERAGE    2024-12-16     13254   \n",
       "217          4466  AMERICAN VINTAGE BEVERAGE    2024-12-26     13432   \n",
       "218          4466  AMERICAN VINTAGE BEVERAGE    2024-12-30     13483   \n",
       "219          4466  AMERICAN VINTAGE BEVERAGE    2025-01-09     13627   \n",
       "\n",
       "         PODate     PayDate  Quantity  Dollars  Freight Approval  \n",
       "0    2023-12-22  2024-02-21        15   140.55     8.57     None  \n",
       "1    2023-12-27  2024-02-26       335  3142.33    16.97     None  \n",
       "2    2024-01-03  2024-02-18        41   383.35     1.99     None  \n",
       "3    2024-01-14  2024-03-11        72   673.20     3.30     None  \n",
       "4    2024-01-19  2024-03-15        79   740.21     3.48     None  \n",
       "..          ...         ...       ...      ...      ...      ...  \n",
       "215  2024-11-20  2025-01-18       305  3018.89    15.70     None  \n",
       "216  2024-11-28  2025-01-13       262  2530.36    11.39     None  \n",
       "217  2024-12-09  2025-01-27       231  2263.43    11.32     None  \n",
       "218  2024-12-13  2025-02-11       221  2178.27    11.33     None  \n",
       "219  2024-12-22  2025-02-05       413  3985.03    19.53     None  \n",
       "\n",
       "[220 rows x 10 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_invoice"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "b0bceef1-49cf-4482-8506-12ae78805936",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "55"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_invoice['PONumber'].nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "0f97bfb5-351c-4b88-b79d-fa7fb2181a49",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(220, 10)"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_invoice.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "32d8173d-e14d-4823-9aae-80f353816d35",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['VendorNumber', 'VendorName', 'InvoiceDate', 'PONumber', 'PODate',\n",
       "       'PayDate', 'Quantity', 'Dollars', 'Freight', 'Approval'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_invoice.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "e4091141-41ec-47ab-b8d1-92a1f397557c",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "\n",
    "conn = sqlite3.connect(\"inventory.db\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "3ccfa0d8-d9c4-4b1d-b76f-c866628e5811",
   "metadata": {},
   "outputs": [],
   "source": [
    "sales = pd.read_sql_query(\n",
    "    \"SELECT * FROM sales;\",\n",
    "    conn\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "d5c69848-252a-4581-89ca-abd9036d9353",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SalesDollars</th>\n",
       "      <th>SalesPrice</th>\n",
       "      <th>SalesQuantity</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Brand</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>58</th>\n",
       "      <td>7469.25</td>\n",
       "      <td>5299.92</td>\n",
       "      <td>575</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>60</th>\n",
       "      <td>2237.88</td>\n",
       "      <td>1615.48</td>\n",
       "      <td>212</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>839.40</td>\n",
       "      <td>69.95</td>\n",
       "      <td>60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62</th>\n",
       "      <td>15849.93</td>\n",
       "      <td>12651.75</td>\n",
       "      <td>407</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>13597.66</td>\n",
       "      <td>10948.31</td>\n",
       "      <td>334</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90085</th>\n",
       "      <td>258.93</td>\n",
       "      <td>73.98</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90086</th>\n",
       "      <td>103.98</td>\n",
       "      <td>103.98</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90087</th>\n",
       "      <td>939.98</td>\n",
       "      <td>939.98</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90089</th>\n",
       "      <td>3719.69</td>\n",
       "      <td>719.94</td>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90090</th>\n",
       "      <td>2599.96</td>\n",
       "      <td>649.99</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8193 rows  3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       SalesDollars  SalesPrice  SalesQuantity\n",
       "Brand                                         \n",
       "58          7469.25     5299.92            575\n",
       "60          2237.88     1615.48            212\n",
       "61           839.40       69.95             60\n",
       "62         15849.93    12651.75            407\n",
       "63         13597.66    10948.31            334\n",
       "...             ...         ...            ...\n",
       "90085        258.93       73.98              7\n",
       "90086        103.98      103.98              2\n",
       "90087        939.98      939.98              2\n",
       "90089       3719.69      719.94             31\n",
       "90090       2599.96      649.99              4\n",
       "\n",
       "[8193 rows x 3 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sales.groupby('Brand')[['SalesDollars', 'SalesPrice', 'SalesQuantity']].sum()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "91e38f6b-6921-44c9-8972-f5a002411b0c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['VendorNumber', 'VendorName', 'InvoiceDate', 'PONumber', 'PODate',\n",
       "       'PayDate', 'Quantity', 'Dollars', 'Freight', 'Approval'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_invoice.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "f95cfcd0-52ea-474f-8d7c-f5c19d86f17b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>FreightCost</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>108.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>54</td>\n",
       "      <td>1.92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>60</td>\n",
       "      <td>1470.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>105</td>\n",
       "      <td>249.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>200</td>\n",
       "      <td>24.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>121</th>\n",
       "      <td>98450</td>\n",
       "      <td>3424.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>122</th>\n",
       "      <td>99166</td>\n",
       "      <td>520.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>123</th>\n",
       "      <td>172662</td>\n",
       "      <td>713.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>173357</td>\n",
       "      <td>810.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>201359</td>\n",
       "      <td>0.36</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>126 rows  2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     VendorNumber  FreightCost\n",
       "0               2       108.32\n",
       "1              54         1.92\n",
       "2              60      1470.08\n",
       "3             105       249.56\n",
       "4             200        24.76\n",
       "..            ...          ...\n",
       "121         98450      3424.08\n",
       "122         99166       520.36\n",
       "123        172662       713.36\n",
       "124        173357       810.00\n",
       "125        201359         0.36\n",
       "\n",
       "[126 rows x 2 columns]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "freight_summary = pd.read_sql_query(\n",
    "    \"\"\"\n",
    "    SELECT \n",
    "        VendorNumber,\n",
    "        SUM(Freight) AS FreightCost\n",
    "    FROM vendor_invoice\n",
    "    GROUP BY VendorNumber\n",
    "    \"\"\",\n",
    "    conn\n",
    ")\n",
    "\n",
    "freight_summary\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "1c131f6d-e436-4941-940e-916bc984e70d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>cid</th>\n",
       "      <th>name</th>\n",
       "      <th>type</th>\n",
       "      <th>notnull</th>\n",
       "      <th>dflt_value</th>\n",
       "      <th>pk</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>Brand</td>\n",
       "      <td>BIGINT</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>Description</td>\n",
       "      <td>TEXT</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>Price</td>\n",
       "      <td>FLOAT</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>Size</td>\n",
       "      <td>TEXT</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>Volume</td>\n",
       "      <td>BIGINT</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>Classification</td>\n",
       "      <td>BIGINT</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6</td>\n",
       "      <td>PurchasePrice</td>\n",
       "      <td>FLOAT</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>VendorNumber</td>\n",
       "      <td>BIGINT</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>8</td>\n",
       "      <td>VendorName</td>\n",
       "      <td>TEXT</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   cid            name    type  notnull dflt_value  pk\n",
       "0    0           Brand  BIGINT        0       None   0\n",
       "1    1     Description    TEXT        0       None   0\n",
       "2    2           Price   FLOAT        0       None   0\n",
       "3    3            Size    TEXT        0       None   0\n",
       "4    4          Volume  BIGINT        0       None   0\n",
       "5    5  Classification  BIGINT        0       None   0\n",
       "6    6   PurchasePrice   FLOAT        0       None   0\n",
       "7    7    VendorNumber  BIGINT        0       None   0\n",
       "8    8      VendorName    TEXT        0       None   0"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.read_sql_query(\n",
    "    \"PRAGMA table_info(purchase_prices);\",\n",
    "    conn\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "6dd570d1-4a74-40c1-a43d-14c598aeb86f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>Brand</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>TotalPurchaseQuantity</th>\n",
       "      <th>TotalPurchaseDollars</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1128</td>\n",
       "      <td>BROWN-FORMAN CORP</td>\n",
       "      <td>1233</td>\n",
       "      <td>26.27</td>\n",
       "      <td>145080</td>\n",
       "      <td>3811251.60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4425</td>\n",
       "      <td>MARTIGNETTI COMPANIES</td>\n",
       "      <td>3405</td>\n",
       "      <td>23.19</td>\n",
       "      <td>164038</td>\n",
       "      <td>3804041.22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>17035</td>\n",
       "      <td>PERNOD RICARD USA</td>\n",
       "      <td>8068</td>\n",
       "      <td>18.24</td>\n",
       "      <td>187407</td>\n",
       "      <td>3418303.68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3960</td>\n",
       "      <td>DIAGEO NORTH AMERICA INC</td>\n",
       "      <td>4261</td>\n",
       "      <td>16.17</td>\n",
       "      <td>201682</td>\n",
       "      <td>3261197.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3960</td>\n",
       "      <td>DIAGEO NORTH AMERICA INC</td>\n",
       "      <td>3545</td>\n",
       "      <td>21.89</td>\n",
       "      <td>138109</td>\n",
       "      <td>3023206.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10687</th>\n",
       "      <td>9815</td>\n",
       "      <td>WINE GROUP INC</td>\n",
       "      <td>8527</td>\n",
       "      <td>1.32</td>\n",
       "      <td>2</td>\n",
       "      <td>2.64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10688</th>\n",
       "      <td>8004</td>\n",
       "      <td>SAZERAC CO INC</td>\n",
       "      <td>5683</td>\n",
       "      <td>0.39</td>\n",
       "      <td>6</td>\n",
       "      <td>2.34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10689</th>\n",
       "      <td>3924</td>\n",
       "      <td>HEAVEN HILL DISTILLERIES</td>\n",
       "      <td>9123</td>\n",
       "      <td>0.74</td>\n",
       "      <td>2</td>\n",
       "      <td>1.48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10690</th>\n",
       "      <td>3960</td>\n",
       "      <td>DIAGEO NORTH AMERICA INC</td>\n",
       "      <td>6127</td>\n",
       "      <td>1.47</td>\n",
       "      <td>1</td>\n",
       "      <td>1.47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10691</th>\n",
       "      <td>7245</td>\n",
       "      <td>PROXIMO SPIRITS INC.</td>\n",
       "      <td>3065</td>\n",
       "      <td>0.71</td>\n",
       "      <td>1</td>\n",
       "      <td>0.71</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10692 rows  6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       VendorNumber                   VendorName  Brand  PurchasePrice  \\\n",
       "0              1128  BROWN-FORMAN CORP             1233          26.27   \n",
       "1              4425        MARTIGNETTI COMPANIES   3405          23.19   \n",
       "2             17035  PERNOD RICARD USA             8068          18.24   \n",
       "3              3960  DIAGEO NORTH AMERICA INC      4261          16.17   \n",
       "4              3960  DIAGEO NORTH AMERICA INC      3545          21.89   \n",
       "...             ...                          ...    ...            ...   \n",
       "10687          9815  WINE GROUP INC                8527           1.32   \n",
       "10688          8004  SAZERAC CO INC                5683           0.39   \n",
       "10689          3924  HEAVEN HILL DISTILLERIES      9123           0.74   \n",
       "10690          3960  DIAGEO NORTH AMERICA INC      6127           1.47   \n",
       "10691          7245  PROXIMO SPIRITS INC.          3065           0.71   \n",
       "\n",
       "       TotalPurchaseQuantity  TotalPurchaseDollars  \n",
       "0                     145080            3811251.60  \n",
       "1                     164038            3804041.22  \n",
       "2                     187407            3418303.68  \n",
       "3                     201682            3261197.94  \n",
       "4                     138109            3023206.01  \n",
       "...                      ...                   ...  \n",
       "10687                      2                  2.64  \n",
       "10688                      6                  2.34  \n",
       "10689                      2                  1.48  \n",
       "10690                      1                  1.47  \n",
       "10691                      1                  0.71  \n",
       "\n",
       "[10692 rows x 6 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "\n",
    "with sqlite3.connect(\"inventory.db\") as conn:\n",
    "    purchase_summary = pd.read_sql_query(\n",
    "        \"\"\"\n",
    "        SELECT \n",
    "            VendorNumber,\n",
    "            VendorName,\n",
    "            Brand,\n",
    "            PurchasePrice,\n",
    "            SUM(Quantity) AS TotalPurchaseQuantity,\n",
    "            SUM(Dollars) AS TotalPurchaseDollars\n",
    "        FROM purchases\n",
    "        WHERE PurchasePrice > 0\n",
    "        GROUP BY \n",
    "            VendorNumber,\n",
    "            VendorName,\n",
    "            Brand,\n",
    "            PurchasePrice\n",
    "        ORDER BY TotalPurchaseDollars DESC\n",
    "        \"\"\",\n",
    "        conn\n",
    "    )\n",
    "\n",
    "purchase_summary\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "e23380a1-8c24-42be-9473-e4d2560dd0d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "sales = pd.read_sql_query(\"SELECT * FROM sales;\", conn)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "3e31bafa-e351-4fb3-b85b-665e6a70732e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['InventoryId', 'Store', 'Brand', 'Description', 'Size', 'SalesQuantity',\n",
       "       'SalesDollars', 'SalesPrice', 'SalesDate', 'Volume', 'Classification',\n",
       "       'ExciseTax', 'VendorNo', 'VendorName'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sales.columns\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "5c08368f-68cb-4de2-b8cf-97a1c19b8d54",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNo</th>\n",
       "      <th>Brand</th>\n",
       "      <th>TotalSalesDollars</th>\n",
       "      <th>TotalSalesPrice</th>\n",
       "      <th>TotalSalesQuntity</th>\n",
       "      <th>TotalExciseTax</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>90085</td>\n",
       "      <td>258.93</td>\n",
       "      <td>73.98</td>\n",
       "      <td>7</td>\n",
       "      <td>0.78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>60</td>\n",
       "      <td>771</td>\n",
       "      <td>14.99</td>\n",
       "      <td>14.99</td>\n",
       "      <td>1</td>\n",
       "      <td>0.79</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>105</td>\n",
       "      <td>8412</td>\n",
       "      <td>2099.58</td>\n",
       "      <td>1799.64</td>\n",
       "      <td>42</td>\n",
       "      <td>33.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>105</td>\n",
       "      <td>8419</td>\n",
       "      <td>41.94</td>\n",
       "      <td>41.94</td>\n",
       "      <td>6</td>\n",
       "      <td>0.60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>287</td>\n",
       "      <td>24921</td>\n",
       "      <td>92.94</td>\n",
       "      <td>92.94</td>\n",
       "      <td>6</td>\n",
       "      <td>0.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8188</th>\n",
       "      <td>98450</td>\n",
       "      <td>8543</td>\n",
       "      <td>2486.66</td>\n",
       "      <td>1567.17</td>\n",
       "      <td>134</td>\n",
       "      <td>105.61</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8189</th>\n",
       "      <td>172662</td>\n",
       "      <td>2872</td>\n",
       "      <td>63.98</td>\n",
       "      <td>63.98</td>\n",
       "      <td>2</td>\n",
       "      <td>1.58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8190</th>\n",
       "      <td>172662</td>\n",
       "      <td>3632</td>\n",
       "      <td>85.47</td>\n",
       "      <td>85.47</td>\n",
       "      <td>3</td>\n",
       "      <td>2.37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8191</th>\n",
       "      <td>172662</td>\n",
       "      <td>4215</td>\n",
       "      <td>155.94</td>\n",
       "      <td>25.99</td>\n",
       "      <td>6</td>\n",
       "      <td>4.72</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8192</th>\n",
       "      <td>173357</td>\n",
       "      <td>3909</td>\n",
       "      <td>2898.84</td>\n",
       "      <td>1799.28</td>\n",
       "      <td>116</td>\n",
       "      <td>91.38</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8193 rows  6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      VendorNo  Brand  TotalSalesDollars  TotalSalesPrice  TotalSalesQuntity  \\\n",
       "0            2  90085             258.93            73.98                  7   \n",
       "1           60    771              14.99            14.99                  1   \n",
       "2          105   8412            2099.58          1799.64                 42   \n",
       "3          105   8419              41.94            41.94                  6   \n",
       "4          287  24921              92.94            92.94                  6   \n",
       "...        ...    ...                ...              ...                ...   \n",
       "8188     98450   8543            2486.66          1567.17                134   \n",
       "8189    172662   2872              63.98            63.98                  2   \n",
       "8190    172662   3632              85.47            85.47                  3   \n",
       "8191    172662   4215             155.94            25.99                  6   \n",
       "8192    173357   3909            2898.84          1799.28                116   \n",
       "\n",
       "      TotalExciseTax  \n",
       "0               0.78  \n",
       "1               0.79  \n",
       "2              33.13  \n",
       "3               0.60  \n",
       "4               0.66  \n",
       "...              ...  \n",
       "8188          105.61  \n",
       "8189            1.58  \n",
       "8190            2.37  \n",
       "8191            4.72  \n",
       "8192           91.38  \n",
       "\n",
       "[8193 rows x 6 columns]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.read_sql_query(\"\"\"    SELECT \n",
    "vendorNo,\n",
    "Brand,\n",
    "SUM(SalesDollars) as  TotalSalesDollars,\n",
    "SUM (SalesPrice) as TotalSalesPrice,\n",
    "SUM(SalesQuantity) as TotalSalesQuntity,\n",
    "SUM(ExciseTax) as TotalExciseTax\n",
    "FROM sales  \n",
    "GROUP BY VendorNo , Brand\"\"\",conn)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "5303e326-83cf-4042-9baf-552f776242bd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Volume</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>ActualPrice</th>\n",
       "      <th>TotalPurchaseQuantity</th>\n",
       "      <th>TotalPurchaseDollars</th>\n",
       "      <th>TotalSalesQuantity</th>\n",
       "      <th>TotalSalesDollars</th>\n",
       "      <th>TotalSalesPrice</th>\n",
       "      <th>TotalExciseTax</th>\n",
       "      <th>FreightCost</th>\n",
       "      <th>Profit</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>90037</td>\n",
       "      <td>THE PIERPONT GROUP LLC</td>\n",
       "      <td>2163</td>\n",
       "      <td>Sloane's Gin</td>\n",
       "      <td>750mL</td>\n",
       "      <td>14.38</td>\n",
       "      <td>20.598696</td>\n",
       "      <td>91</td>\n",
       "      <td>1308.58</td>\n",
       "      <td>174.0</td>\n",
       "      <td>3553.26</td>\n",
       "      <td>2368.85</td>\n",
       "      <td>137.18</td>\n",
       "      <td>111.92</td>\n",
       "      <td>2132.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2396</td>\n",
       "      <td>BLACK PRINCE DISTILLERY INC</td>\n",
       "      <td>3079</td>\n",
       "      <td>Devils Spring Vodka</td>\n",
       "      <td>750mL</td>\n",
       "      <td>10.21</td>\n",
       "      <td>14.098527</td>\n",
       "      <td>420</td>\n",
       "      <td>4288.20</td>\n",
       "      <td>456.0</td>\n",
       "      <td>6231.44</td>\n",
       "      <td>3637.42</td>\n",
       "      <td>359.25</td>\n",
       "      <td>123.92</td>\n",
       "      <td>1819.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>90047</td>\n",
       "      <td>CRUSH WINES</td>\n",
       "      <td>23218</td>\n",
       "      <td>Tangent Chard</td>\n",
       "      <td>750mL</td>\n",
       "      <td>6.70</td>\n",
       "      <td>9.990000</td>\n",
       "      <td>663</td>\n",
       "      <td>4442.10</td>\n",
       "      <td>1154.0</td>\n",
       "      <td>11528.46</td>\n",
       "      <td>5344.65</td>\n",
       "      <td>128.60</td>\n",
       "      <td>5830.92</td>\n",
       "      <td>1255.44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>90037</td>\n",
       "      <td>THE PIERPONT GROUP LLC</td>\n",
       "      <td>3770</td>\n",
       "      <td>Miodula Honey Vodka</td>\n",
       "      <td>750mL</td>\n",
       "      <td>14.17</td>\n",
       "      <td>19.546962</td>\n",
       "      <td>142</td>\n",
       "      <td>2012.14</td>\n",
       "      <td>141.0</td>\n",
       "      <td>2729.59</td>\n",
       "      <td>1544.21</td>\n",
       "      <td>111.11</td>\n",
       "      <td>111.92</td>\n",
       "      <td>605.53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2555</td>\n",
       "      <td>DISARONNO INTERNATIONAL LLC</td>\n",
       "      <td>1212</td>\n",
       "      <td>DiSaronna Amaretto Sour VAP</td>\n",
       "      <td>750mL</td>\n",
       "      <td>14.38</td>\n",
       "      <td>21.872521</td>\n",
       "      <td>563</td>\n",
       "      <td>8095.94</td>\n",
       "      <td>1467.0</td>\n",
       "      <td>32089.33</td>\n",
       "      <td>15267.02</td>\n",
       "      <td>1155.39</td>\n",
       "      <td>23444.12</td>\n",
       "      <td>549.27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10693</th>\n",
       "      <td>172662</td>\n",
       "      <td>SWEETWATER FARM</td>\n",
       "      <td>2265</td>\n",
       "      <td>Monadnock Moonshine</td>\n",
       "      <td>750mL</td>\n",
       "      <td>21.47</td>\n",
       "      <td>NaN</td>\n",
       "      <td>267</td>\n",
       "      <td>5732.49</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>713.36</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10694</th>\n",
       "      <td>173357</td>\n",
       "      <td>TAMWORTH DISTILLING</td>\n",
       "      <td>2804</td>\n",
       "      <td>Camp Robber Whiskey</td>\n",
       "      <td>750mL</td>\n",
       "      <td>32.14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>210</td>\n",
       "      <td>6749.40</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>810.00</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10695</th>\n",
       "      <td>173357</td>\n",
       "      <td>TAMWORTH DISTILLING</td>\n",
       "      <td>3666</td>\n",
       "      <td>Art in the Age Chicory Root</td>\n",
       "      <td>375mL</td>\n",
       "      <td>18.79</td>\n",
       "      <td>NaN</td>\n",
       "      <td>520</td>\n",
       "      <td>9770.80</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>810.00</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10696</th>\n",
       "      <td>173357</td>\n",
       "      <td>TAMWORTH DISTILLING</td>\n",
       "      <td>3848</td>\n",
       "      <td>Chicory Root Vodka</td>\n",
       "      <td>750mL</td>\n",
       "      <td>23.30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>28</td>\n",
       "      <td>652.40</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>810.00</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10697</th>\n",
       "      <td>201359</td>\n",
       "      <td>FLAVOR ESSENCE INC</td>\n",
       "      <td>90609</td>\n",
       "      <td>Flavor Essence Variety 5 Pak</td>\n",
       "      <td>5/2 oz</td>\n",
       "      <td>17.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>17.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.36</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10698 rows  15 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       VendorNumber                   VendorName  Brand  \\\n",
       "0             90037  THE PIERPONT GROUP LLC        2163   \n",
       "1              2396  BLACK PRINCE DISTILLERY INC   3079   \n",
       "2             90047  CRUSH WINES                  23218   \n",
       "3             90037  THE PIERPONT GROUP LLC        3770   \n",
       "4              2555  DISARONNO INTERNATIONAL LLC   1212   \n",
       "...             ...                          ...    ...   \n",
       "10693        172662     SWEETWATER FARM            2265   \n",
       "10694        173357  TAMWORTH DISTILLING           2804   \n",
       "10695        173357  TAMWORTH DISTILLING           3666   \n",
       "10696        173357  TAMWORTH DISTILLING           3848   \n",
       "10697        201359  FLAVOR ESSENCE INC           90609   \n",
       "\n",
       "                        Description  Volume  PurchasePrice  ActualPrice  \\\n",
       "0                      Sloane's Gin   750mL          14.38    20.598696   \n",
       "1               Devils Spring Vodka   750mL          10.21    14.098527   \n",
       "2                     Tangent Chard   750mL           6.70     9.990000   \n",
       "3               Miodula Honey Vodka   750mL          14.17    19.546962   \n",
       "4       DiSaronna Amaretto Sour VAP   750mL          14.38    21.872521   \n",
       "...                             ...     ...            ...          ...   \n",
       "10693           Monadnock Moonshine   750mL          21.47          NaN   \n",
       "10694           Camp Robber Whiskey   750mL          32.14          NaN   \n",
       "10695   Art in the Age Chicory Root   375mL          18.79          NaN   \n",
       "10696            Chicory Root Vodka   750mL          23.30          NaN   \n",
       "10697  Flavor Essence Variety 5 Pak  5/2 oz          17.00          NaN   \n",
       "\n",
       "       TotalPurchaseQuantity  TotalPurchaseDollars  TotalSalesQuantity  \\\n",
       "0                         91               1308.58               174.0   \n",
       "1                        420               4288.20               456.0   \n",
       "2                        663               4442.10              1154.0   \n",
       "3                        142               2012.14               141.0   \n",
       "4                        563               8095.94              1467.0   \n",
       "...                      ...                   ...                 ...   \n",
       "10693                    267               5732.49                 NaN   \n",
       "10694                    210               6749.40                 NaN   \n",
       "10695                    520               9770.80                 NaN   \n",
       "10696                     28                652.40                 NaN   \n",
       "10697                      1                 17.00                 NaN   \n",
       "\n",
       "       TotalSalesDollars  TotalSalesPrice  TotalExciseTax  FreightCost  \\\n",
       "0                3553.26          2368.85          137.18       111.92   \n",
       "1                6231.44          3637.42          359.25       123.92   \n",
       "2               11528.46          5344.65          128.60      5830.92   \n",
       "3                2729.59          1544.21          111.11       111.92   \n",
       "4               32089.33         15267.02         1155.39     23444.12   \n",
       "...                  ...              ...             ...          ...   \n",
       "10693                NaN              NaN             NaN       713.36   \n",
       "10694                NaN              NaN             NaN       810.00   \n",
       "10695                NaN              NaN             NaN       810.00   \n",
       "10696                NaN              NaN             NaN       810.00   \n",
       "10697                NaN              NaN             NaN         0.36   \n",
       "\n",
       "        Profit  \n",
       "0      2132.76  \n",
       "1      1819.32  \n",
       "2      1255.44  \n",
       "3       605.53  \n",
       "4       549.27  \n",
       "...        ...  \n",
       "10693      NaN  \n",
       "10694      NaN  \n",
       "10695      NaN  \n",
       "10696      NaN  \n",
       "10697      NaN  \n",
       "\n",
       "[10698 rows x 15 columns]"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_sales_summary = pd.read_sql_query(\n",
    "    \"\"\"\n",
    "    WITH FreightSummary AS (\n",
    "        SELECT \n",
    "            VendorNumber,\n",
    "            SUM(Freight) AS FreightCost\n",
    "        FROM vendor_invoice\n",
    "        GROUP BY VendorNumber\n",
    "    ),\n",
    "\n",
    "    PurchaseSummary AS (\n",
    "        SELECT \n",
    "            VendorNumber,\n",
    "            VendorName,\n",
    "            Brand,\n",
    "            Description,\n",
    "            Size AS Volume,\n",
    "            PurchasePrice,\n",
    "            SUM(Quantity) AS TotalPurchaseQuantity,\n",
    "            SUM(Dollars) AS TotalPurchaseDollars\n",
    "        FROM purchases\n",
    "        WHERE PurchasePrice > 0\n",
    "        GROUP BY \n",
    "            VendorNumber,\n",
    "            VendorName,\n",
    "            Brand,\n",
    "            Description,\n",
    "            Size,\n",
    "            PurchasePrice\n",
    "    ),\n",
    "\n",
    "    SalesSummary AS (\n",
    "        SELECT \n",
    "            Brand,\n",
    "            Description,\n",
    "            AVG(SalesPrice) AS ActualPrice,\n",
    "            SUM(SalesPrice) AS TotalSalesPrice,\n",
    "            SUM(SalesQuantity) AS TotalSalesQuantity,\n",
    "            SUM(SalesDollars) AS TotalSalesDollars,\n",
    "            SUM(ExciseTax) AS TotalExciseTax\n",
    "        FROM sales\n",
    "        GROUP BY Brand, Description\n",
    "    )\n",
    "\n",
    "    SELECT \n",
    "        ps.VendorNumber,\n",
    "        ps.VendorName,\n",
    "        ps.Brand,\n",
    "        ps.Description,\n",
    "        ps.Volume,\n",
    "        ps.PurchasePrice,\n",
    "        ss.ActualPrice,\n",
    "\n",
    "        ps.TotalPurchaseQuantity,\n",
    "        ps.TotalPurchaseDollars,\n",
    "\n",
    "        ss.TotalSalesQuantity,\n",
    "        ss.TotalSalesDollars,\n",
    "        ss.TotalSalesPrice,\n",
    "        ss.TotalExciseTax,\n",
    "\n",
    "        COALESCE(fs.FreightCost, 0) AS FreightCost,\n",
    "\n",
    "        ss.TotalSalesDollars\n",
    "        - ps.TotalPurchaseDollars\n",
    "        - COALESCE(fs.FreightCost, 0) AS Profit\n",
    "\n",
    "    FROM PurchaseSummary ps\n",
    "    LEFT JOIN SalesSummary ss\n",
    "        ON ps.Brand = ss.Brand\n",
    "       AND ps.Description = ss.Description\n",
    "    LEFT JOIN FreightSummary fs\n",
    "        ON ps.VendorNumber = fs.VendorNumber\n",
    "\n",
    "    ORDER BY Profit DESC\n",
    "    \"\"\",\n",
    "    conn\n",
    ")\n",
    "\n",
    "vendor_sales_summary\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f695d256-42ec-40b1-aadd-bd71661f8d0f",
   "metadata": {},
   "source": [
    "THis Query Genrates a vendor - wise sales and Purchase summary which is  valuable for :\n",
    "\n",
    "Performamce  optimistion\n",
    ": The queryu involves heavy joind and aggregation on large data sets like purchases \n",
    ": storing the pre- aggregated result  avoid repeted expensive computation.\n",
    ":\n",
    "helping in analyzing sales ,Purcheses And pricing for different  vendor and brands.\n",
    ":future Benfites of storing this data for faster dashbording & Reporting \n",
    ":Instead of running expensive Queries each time dashboard can fetch data quickily form vendor_sales_summary .\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "17adb538-e2ee-451a-9c68-6faa3a06381a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "VendorNumber               int64\n",
       "VendorName                object\n",
       "Brand                      int64\n",
       "Description               object\n",
       "Volume                    object\n",
       "PurchasePrice            float64\n",
       "ActualPrice              float64\n",
       "TotalPurchaseQuantity      int64\n",
       "TotalPurchaseDollars     float64\n",
       "TotalSalesQuantity       float64\n",
       "TotalSalesDollars        float64\n",
       "TotalSalesPrice          float64\n",
       "TotalExciseTax           float64\n",
       "FreightCost              float64\n",
       "Profit                   float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_sales_summary.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "fed0efe1-43f1-48c0-96b0-92cfede148c1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "VendorNumber                0\n",
       "VendorName                  0\n",
       "Brand                       0\n",
       "Description                 0\n",
       "Volume                      3\n",
       "PurchasePrice               0\n",
       "ActualPrice              3064\n",
       "TotalPurchaseQuantity       0\n",
       "TotalPurchaseDollars        0\n",
       "TotalSalesQuantity       3064\n",
       "TotalSalesDollars        3064\n",
       "TotalSalesPrice          3064\n",
       "TotalExciseTax           3064\n",
       "FreightCost                 0\n",
       "Profit                   3064\n",
       "dtype: int64"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_sales_summary.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "e8ae2ea3-4a5f-4e54-82ce-733f86b65c31",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Volume</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>ActualPrice</th>\n",
       "      <th>TotalPurchaseQuantity</th>\n",
       "      <th>TotalPurchaseDollars</th>\n",
       "      <th>TotalSalesQuantity</th>\n",
       "      <th>TotalSalesDollars</th>\n",
       "      <th>TotalSalesPrice</th>\n",
       "      <th>TotalExciseTax</th>\n",
       "      <th>FreightCost</th>\n",
       "      <th>Profit</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>90037</td>\n",
       "      <td>THE PIERPONT GROUP LLC</td>\n",
       "      <td>2163</td>\n",
       "      <td>Sloane's Gin</td>\n",
       "      <td>750mL</td>\n",
       "      <td>14.38</td>\n",
       "      <td>20.598696</td>\n",
       "      <td>91</td>\n",
       "      <td>1308.58</td>\n",
       "      <td>174.0</td>\n",
       "      <td>3553.26</td>\n",
       "      <td>2368.85</td>\n",
       "      <td>137.18</td>\n",
       "      <td>111.92</td>\n",
       "      <td>2132.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2396</td>\n",
       "      <td>BLACK PRINCE DISTILLERY INC</td>\n",
       "      <td>3079</td>\n",
       "      <td>Devils Spring Vodka</td>\n",
       "      <td>750mL</td>\n",
       "      <td>10.21</td>\n",
       "      <td>14.098527</td>\n",
       "      <td>420</td>\n",
       "      <td>4288.20</td>\n",
       "      <td>456.0</td>\n",
       "      <td>6231.44</td>\n",
       "      <td>3637.42</td>\n",
       "      <td>359.25</td>\n",
       "      <td>123.92</td>\n",
       "      <td>1819.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>90047</td>\n",
       "      <td>CRUSH WINES</td>\n",
       "      <td>23218</td>\n",
       "      <td>Tangent Chard</td>\n",
       "      <td>750mL</td>\n",
       "      <td>6.70</td>\n",
       "      <td>9.990000</td>\n",
       "      <td>663</td>\n",
       "      <td>4442.10</td>\n",
       "      <td>1154.0</td>\n",
       "      <td>11528.46</td>\n",
       "      <td>5344.65</td>\n",
       "      <td>128.60</td>\n",
       "      <td>5830.92</td>\n",
       "      <td>1255.44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>90037</td>\n",
       "      <td>THE PIERPONT GROUP LLC</td>\n",
       "      <td>3770</td>\n",
       "      <td>Miodula Honey Vodka</td>\n",
       "      <td>750mL</td>\n",
       "      <td>14.17</td>\n",
       "      <td>19.546962</td>\n",
       "      <td>142</td>\n",
       "      <td>2012.14</td>\n",
       "      <td>141.0</td>\n",
       "      <td>2729.59</td>\n",
       "      <td>1544.21</td>\n",
       "      <td>111.11</td>\n",
       "      <td>111.92</td>\n",
       "      <td>605.53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2555</td>\n",
       "      <td>DISARONNO INTERNATIONAL LLC</td>\n",
       "      <td>1212</td>\n",
       "      <td>DiSaronna Amaretto Sour VAP</td>\n",
       "      <td>750mL</td>\n",
       "      <td>14.38</td>\n",
       "      <td>21.872521</td>\n",
       "      <td>563</td>\n",
       "      <td>8095.94</td>\n",
       "      <td>1467.0</td>\n",
       "      <td>32089.33</td>\n",
       "      <td>15267.02</td>\n",
       "      <td>1155.39</td>\n",
       "      <td>23444.12</td>\n",
       "      <td>549.27</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   VendorNumber                   VendorName  Brand  \\\n",
       "0         90037  THE PIERPONT GROUP LLC        2163   \n",
       "1          2396  BLACK PRINCE DISTILLERY INC   3079   \n",
       "2         90047  CRUSH WINES                  23218   \n",
       "3         90037  THE PIERPONT GROUP LLC        3770   \n",
       "4          2555  DISARONNO INTERNATIONAL LLC   1212   \n",
       "\n",
       "                   Description Volume  PurchasePrice  ActualPrice  \\\n",
       "0                 Sloane's Gin  750mL          14.38    20.598696   \n",
       "1          Devils Spring Vodka  750mL          10.21    14.098527   \n",
       "2                Tangent Chard  750mL           6.70     9.990000   \n",
       "3          Miodula Honey Vodka  750mL          14.17    19.546962   \n",
       "4  DiSaronna Amaretto Sour VAP  750mL          14.38    21.872521   \n",
       "\n",
       "   TotalPurchaseQuantity  TotalPurchaseDollars  TotalSalesQuantity  \\\n",
       "0                     91               1308.58               174.0   \n",
       "1                    420               4288.20               456.0   \n",
       "2                    663               4442.10              1154.0   \n",
       "3                    142               2012.14               141.0   \n",
       "4                    563               8095.94              1467.0   \n",
       "\n",
       "   TotalSalesDollars  TotalSalesPrice  TotalExciseTax  FreightCost   Profit  \n",
       "0            3553.26          2368.85          137.18       111.92  2132.76  \n",
       "1            6231.44          3637.42          359.25       123.92  1819.32  \n",
       "2           11528.46          5344.65          128.60      5830.92  1255.44  \n",
       "3            2729.59          1544.21          111.11       111.92   605.53  \n",
       "4           32089.33         15267.02         1155.39     23444.12   549.27  "
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_sales_summary.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "05663e88-a090-409c-9b90-019764e6a959",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['THE PIERPONT GROUP LLC     ', 'BLACK PRINCE DISTILLERY INC',\n",
       "       'CRUSH WINES                ', 'DISARONNO INTERNATIONAL LLC',\n",
       "       'ALISA CARR BEVERAGES           ', 'CAPSTONE INTERNATIONAL     ',\n",
       "       'SILVER MOUNTAIN CIDERS     ', 'THE IMPORTED GRAPE LLC     ',\n",
       "       'R.P.IMPORTS INC            ', 'MILTONS DISTRIBUTING CO    ',\n",
       "       'IRA GOLDMAN AND WILLIAMS, LLP          ',\n",
       "       'FANTASY FINE WINES CORP    ', 'HOOD RIVER DISTILLERS, Inc.',\n",
       "       'VINILANDIA USA             ', 'BRONCO WINE COMPANY        ',\n",
       "       'HIGHLAND WINE MERCHANTS LLC', 'ATLANTIC IMPORTING COMPANY ',\n",
       "       'CENTEUR IMPORTS LLC        ', 'STAR INDUSTRIES INC.       ',\n",
       "       'STELLAR IMPORTING CO LLC   ', 'Circa Wines                ',\n",
       "       'POVERTY LANE ORCHARDS      ', 'VINEXTRA INC               ',\n",
       "       'FORTUNE WINE BROKERS LLC   ', 'BLACK ROCK SPIRITS LLC     ',\n",
       "       'Dunn Wine Brokers          ', 'NICHE W & S                ',\n",
       "       'SURVILLE ENTERPRISES CORP  ', 'MOONLIGHT MEADERY          ',\n",
       "       'APPOLO VINEYARDS LLC       ', 'PARK STREET IMPORTS LLC    ',\n",
       "       'WEIN BAUER INC             ', 'MARSALLE COMPANY           ',\n",
       "       'Russian Standard Vodka     ', 'ADAMBA IMPORTS INTL INC    ',\n",
       "       'SEA BREEZE CELLARS LLC     ', 'KLIN SPIRITS LLC           ',\n",
       "       'HAUNTING WHISPER VYDS      ', 'VINEDREA WINES LLC         ',\n",
       "       'PSP WINES ', 'DJINN SPIRITS LLC          ',\n",
       "       'WALPOLE MTN VIEW WINERY    ', 'WESTERN SPIRITS BEVERAGE CO',\n",
       "       'TY KU LLC                  ', 'PREMIER DISTRIBUTORS       ',\n",
       "       'Serralles Usa LLC          ', 'INCREDIBREW INC            ',\n",
       "       'DUGGANS DISTILLED PRODUCTS ', 'VRANKEN AMERICA            ',\n",
       "       'CANDIA VINEYARDS           ', 'SEA HAGG DISTILLERY LLC    ',\n",
       "       'LAIRD & CO                 ', 'LABELLE VYDS AND WINERY    ',\n",
       "       'FULCHINO VINEYARD INC      ', 'TAKARA SAKE USA INC        ',\n",
       "       'SWEETWATER FARM         ', 'JEWELL TOWNE VINEYARDS     ',\n",
       "       'SMOKY QUARTZ DISTILLERY LLC', 'FLAG HILL WINERY & VINEYARD',\n",
       "       'MCCORMICK DISTILLING CO    ', 'LATITUDE BEVERAGE COMPANY  ',\n",
       "       'CHARLES JACQUIN ET CIE INC ', 'OLE SMOKY DISTILLERY LLC   ',\n",
       "       'PHILLIPS PRODUCTS CO.      ', 'ZORVINO VINEYARDS          ',\n",
       "       'TALL SHIP DISTILLERY LLC   ', 'ALTAMAR BRANDS LLC         ',\n",
       "       'FREDERICK WILDMAN & SONS   ', 'SHAW ROSS INT L IMP LTD    ',\n",
       "       'PREMIUM PORT WINES, INC.   ', 'STATE WINE & SPIRITS   ',\n",
       "       'CALEDONIA SPIRITS INC      ', 'FABRIZIA SPIRITS LLC       ',\n",
       "       'SWEET BABY VINEYARD        ', 'TAMWORTH DISTILLING        ',\n",
       "       'VINEYARD BRANDS INC        ', 'DIAGEO CHATEAU ESTATE WINES',\n",
       "       'SIDNEY FRANK IMPORTING CO  ', 'DELICATO VINEYARDS INC     ',\n",
       "       'KOBRAND CORPORATION        ', 'CASTLE BRANDS CORP.        ',\n",
       "       'EDRINGTON AMERICAS         ', 'MHW LTD                    ',\n",
       "       'BANFI PRODUCTS CORP        ', 'LUXCO INC                  ',\n",
       "       'BULLY BOY DISTILLERS       ', 'AMERICAN VINTAGE BEVERAGE  ',\n",
       "       'TRINCHERO FAMILY ESTATES   ', 'MANGO BOTTLING INC         ',\n",
       "       'PALM BAY INTERNATIONAL INC ', 'HEAVEN HILL DISTILLERIES   ',\n",
       "       'TREASURY WINE ESTATES      ', 'STE MICHELLE WINE ESTATES  ',\n",
       "       'PINE STATE TRADING CO      ', 'REMY COINTREAU USA INC     ',\n",
       "       'SOUTHERN WINE & SPIRITS NE ', 'SAZERAC NORTH AMERICA INC. ',\n",
       "       'MAJESTIC FINE WINES        ', 'STOLI GROUP,(USA) LLC      ',\n",
       "       'CAMPARI AMERICA            ', 'PERFECTA WINES             ',\n",
       "       'WINE GROUP INC             ', 'WILLIAM GRANT & SONS INC   ',\n",
       "       'PROXIMO SPIRITS INC.       ', 'MOET HENNESSY USA INC      ',\n",
       "       'SAZERAC CO INC             ', 'M S WALKER INC             ',\n",
       "       'E & J GALLO WINERY         ', 'ULTRA BEVERAGE COMPANY LLP ',\n",
       "       'BROWN-FORMAN CORP          ', 'CONSTELLATION BRANDS INC   ',\n",
       "       'BACARDI USA INC            ', 'JIM BEAM BRANDS COMPANY    ',\n",
       "       'PERNOD RICARD USA          ', 'MARTIGNETTI COMPANIES',\n",
       "       'MARTIGNETTI COMPANIES ', 'DIAGEO NORTH AMERICA INC   ',\n",
       "       'AAPER ALCOHOL & CHEMICAL CO', 'AMERICAN SPIRITS EXCHANGE  ',\n",
       "       'VINEYARD BRANDS LLC        ', 'SOUTHERN GLAZERS W&S OF NE ',\n",
       "       'GILMANTON WINERY & VINEYARD', 'LAUREATE IMPORTS CO        ',\n",
       "       'LOYAL DOG WINERY           ', 'UNCORKED       ',\n",
       "       'TRUETT HURST               ', 'BLACK COVE BEVERAGES       ',\n",
       "       'STARK BREWING COMPANY      ', 'FLAVOR ESSENCE INC         '],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_sales_summary['VendorName'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "06a9165e-a0b5-4d41-a2df-a716846dab0e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([\"Sloane's Gin\", 'Devils Spring Vodka', 'Tangent Chard', ...,\n",
       "       'Camp Robber Whiskey', 'Art in the Age Chicory Root',\n",
       "       'Chicory Root Vodka'], shape=(9651,), dtype=object)"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_sales_summary['Description'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "1f2fef30-a774-4e27-868b-0d534789f817",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "\n",
    "vendor_sales_summary['Volume'] = (\n",
    "    vendor_sales_summary['Volume']\n",
    "    .astype(str)\n",
    "    .str.upper()\n",
    "    .str.extract(r'(\\d+\\.?\\d*)')[0]   # extract numeric part\n",
    "    .astype(float)\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "27b11ba9-0741-4296-bb5d-881bc4fbadbb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "VendorNumber               int64\n",
       "VendorName                object\n",
       "Brand                      int64\n",
       "Description               object\n",
       "Volume                   float64\n",
       "PurchasePrice            float64\n",
       "ActualPrice              float64\n",
       "TotalPurchaseQuantity      int64\n",
       "TotalPurchaseDollars     float64\n",
       "TotalSalesQuantity       float64\n",
       "TotalSalesDollars        float64\n",
       "TotalSalesPrice          float64\n",
       "TotalExciseTax           float64\n",
       "FreightCost              float64\n",
       "Profit                   float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_sales_summary[['Volume']].head(10)\n",
    "vendor_sales_summary.dtypes\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "c69b5428-9677-4435-88b4-c8232fd20803",
   "metadata": {},
   "outputs": [],
   "source": [
    "vendor_sales_summary['GrossProfit'] = (\n",
    "    vendor_sales_summary['TotalSalesDollars']\n",
    "    - vendor_sales_summary['TotalPurchaseDollars']\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "47802b65-8056-4bc4-b5b2-618b010f260c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "np.float64(-3257140.2300000004)"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_sales_summary['GrossProfit'].min()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "22a596ae-11fa-4956-9555-1bac4325106c",
   "metadata": {},
   "outputs": [],
   "source": [
    "vendor_sales_summary['ProfitMargin'] = (\n",
    "    vendor_sales_summary['GrossProfit']\n",
    "    / vendor_sales_summary['TotalSalesDollars']\n",
    ") * 100\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "4321b872-b69e-4c77-a31c-fdf3b14d1740",
   "metadata": {},
   "outputs": [],
   "source": [
    "vendor_sales_summary['StockTurnover'] = (\n",
    "    vendor_sales_summary['TotalSalesQuantity']\n",
    "    / vendor_sales_summary['TotalPurchaseQuantity']\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "39f8bcc2-82f6-42f1-b56d-f499f2603aa1",
   "metadata": {},
   "outputs": [],
   "source": [
    "vendor_sales_summary['SalesToPurchaseRatio'] = (\n",
    "    vendor_sales_summary['TotalSalesDollars']\n",
    "    / vendor_sales_summary['TotalPurchaseDollars']\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "1a44127f-2eb6-45a8-81dc-18bb58bca7de",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['VendorNumber', 'VendorName', 'Brand', 'Description', 'Volume',\n",
       "       'PurchasePrice', 'ActualPrice', 'TotalPurchaseQuantity',\n",
       "       'TotalPurchaseDollars', 'TotalSalesQuantity', 'TotalSalesDollars',\n",
       "       'TotalSalesPrice', 'TotalExciseTax', 'FreightCost', 'Profit',\n",
       "       'GrossProfit', 'ProfitMargin', 'StockTurnover', 'SalesToPurchaseRatio'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_sales_summary.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "fd07953b-0065-441e-80f3-26bf7b4ca51a",
   "metadata": {},
   "outputs": [],
   "source": [
    "cursor = conn.cursor()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "d7d189e5-c13f-44ed-bae4-dd7988126b37",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<sqlite3.Cursor at 0x1d99e7c5d40>"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cursor.execute(\"DROP TABLE IF EXISTS vendor_sales_summary;\")\n",
    "\n",
    "cursor.execute(\"\"\"\n",
    "CREATE TABLE vendor_sales_summary (\n",
    "    VendorNumber INTEGER,\n",
    "    VendorName VARCHAR(100),\n",
    "    Brand INTEGER,\n",
    "    Description VARCHAR(100),\n",
    "    Volume REAL,\n",
    "    PurchasePrice REAL,\n",
    "    ActualPrice REAL,\n",
    "    TotalPurchaseQuantity INTEGER,\n",
    "    TotalPurchaseDollars REAL,\n",
    "    TotalSalesQuantity INTEGER,\n",
    "    TotalSalesDollars REAL,\n",
    "    TotalSalesPrice REAL,\n",
    "    TotalExciseTax REAL,\n",
    "    FreightCost REAL,\n",
    "    GrossProfit REAL,\n",
    "    ProfitMargin REAL,\n",
    "    StockToPurchaseRatio REAL,\n",
    "    PRIMARY KEY (VendorNumber, Brand, Description)\n",
    ");\n",
    "\"\"\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "dc1cc7c0-4b85-42e1-8fed-de5b8cadf471",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Volume</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>ActualPrice</th>\n",
       "      <th>TotalPurchaseQuantity</th>\n",
       "      <th>TotalPurchaseDollars</th>\n",
       "      <th>TotalSalesQuantity</th>\n",
       "      <th>TotalSalesDollars</th>\n",
       "      <th>TotalSalesPrice</th>\n",
       "      <th>TotalExciseTax</th>\n",
       "      <th>FreightCost</th>\n",
       "      <th>GrossProfit</th>\n",
       "      <th>ProfitMargin</th>\n",
       "      <th>StockToPurchaseRatio</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [VendorNumber, VendorName, Brand, Description, Volume, PurchasePrice, ActualPrice, TotalPurchaseQuantity, TotalPurchaseDollars, TotalSalesQuantity, TotalSalesDollars, TotalSalesPrice, TotalExciseTax, FreightCost, GrossProfit, ProfitMargin, StockToPurchaseRatio]\n",
       "Index: []"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.read_sql_query(\"select * from vendor_sales_summary\",conn)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "0d2f4f5d-8515-492f-93c9-f43ad9a93e24",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "10698"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vendor_sales_summary.to_sql('vendor_sales_summary',conn, if_exists = 'replace', index= False )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "df68fc93-76d8-4319-9e29-b70bffcff931",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorNumber</th>\n",
       "      <th>VendorName</th>\n",
       "      <th>Brand</th>\n",
       "      <th>Description</th>\n",
       "      <th>Volume</th>\n",
       "      <th>PurchasePrice</th>\n",
       "      <th>ActualPrice</th>\n",
       "      <th>TotalPurchaseQuantity</th>\n",
       "      <th>TotalPurchaseDollars</th>\n",
       "      <th>TotalSalesQuantity</th>\n",
       "      <th>TotalSalesDollars</th>\n",
       "      <th>TotalSalesPrice</th>\n",
       "      <th>TotalExciseTax</th>\n",
       "      <th>FreightCost</th>\n",
       "      <th>Profit</th>\n",
       "      <th>GrossProfit</th>\n",
       "      <th>ProfitMargin</th>\n",
       "      <th>StockTurnover</th>\n",
       "      <th>SalesToPurchaseRatio</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>90037</td>\n",
       "      <td>THE PIERPONT GROUP LLC</td>\n",
       "      <td>2163</td>\n",
       "      <td>Sloane's Gin</td>\n",
       "      <td>750.0</td>\n",
       "      <td>14.38</td>\n",
       "      <td>20.598696</td>\n",
       "      <td>91</td>\n",
       "      <td>1308.58</td>\n",
       "      <td>174.0</td>\n",
       "      <td>3553.26</td>\n",
       "      <td>2368.85</td>\n",
       "      <td>137.18</td>\n",
       "      <td>111.92</td>\n",
       "      <td>2132.76</td>\n",
       "      <td>2244.68</td>\n",
       "      <td>63.172411</td>\n",
       "      <td>1.912088</td>\n",
       "      <td>2.715356</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2396</td>\n",
       "      <td>BLACK PRINCE DISTILLERY INC</td>\n",
       "      <td>3079</td>\n",
       "      <td>Devils Spring Vodka</td>\n",
       "      <td>750.0</td>\n",
       "      <td>10.21</td>\n",
       "      <td>14.098527</td>\n",
       "      <td>420</td>\n",
       "      <td>4288.20</td>\n",
       "      <td>456.0</td>\n",
       "      <td>6231.44</td>\n",
       "      <td>3637.42</td>\n",
       "      <td>359.25</td>\n",
       "      <td>123.92</td>\n",
       "      <td>1819.32</td>\n",
       "      <td>1943.24</td>\n",
       "      <td>31.184445</td>\n",
       "      <td>1.085714</td>\n",
       "      <td>1.453160</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>90047</td>\n",
       "      <td>CRUSH WINES</td>\n",
       "      <td>23218</td>\n",
       "      <td>Tangent Chard</td>\n",
       "      <td>750.0</td>\n",
       "      <td>6.70</td>\n",
       "      <td>9.990000</td>\n",
       "      <td>663</td>\n",
       "      <td>4442.10</td>\n",
       "      <td>1154.0</td>\n",
       "      <td>11528.46</td>\n",
       "      <td>5344.65</td>\n",
       "      <td>128.60</td>\n",
       "      <td>5830.92</td>\n",
       "      <td>1255.44</td>\n",
       "      <td>7086.36</td>\n",
       "      <td>61.468401</td>\n",
       "      <td>1.740573</td>\n",
       "      <td>2.595273</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>90037</td>\n",
       "      <td>THE PIERPONT GROUP LLC</td>\n",
       "      <td>3770</td>\n",
       "      <td>Miodula Honey Vodka</td>\n",
       "      <td>750.0</td>\n",
       "      <td>14.17</td>\n",
       "      <td>19.546962</td>\n",
       "      <td>142</td>\n",
       "      <td>2012.14</td>\n",
       "      <td>141.0</td>\n",
       "      <td>2729.59</td>\n",
       "      <td>1544.21</td>\n",
       "      <td>111.11</td>\n",
       "      <td>111.92</td>\n",
       "      <td>605.53</td>\n",
       "      <td>717.45</td>\n",
       "      <td>26.284167</td>\n",
       "      <td>0.992958</td>\n",
       "      <td>1.356561</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2555</td>\n",
       "      <td>DISARONNO INTERNATIONAL LLC</td>\n",
       "      <td>1212</td>\n",
       "      <td>DiSaronna Amaretto Sour VAP</td>\n",
       "      <td>750.0</td>\n",
       "      <td>14.38</td>\n",
       "      <td>21.872521</td>\n",
       "      <td>563</td>\n",
       "      <td>8095.94</td>\n",
       "      <td>1467.0</td>\n",
       "      <td>32089.33</td>\n",
       "      <td>15267.02</td>\n",
       "      <td>1155.39</td>\n",
       "      <td>23444.12</td>\n",
       "      <td>549.27</td>\n",
       "      <td>23993.39</td>\n",
       "      <td>74.770617</td>\n",
       "      <td>2.605684</td>\n",
       "      <td>3.963632</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10693</th>\n",
       "      <td>172662</td>\n",
       "      <td>SWEETWATER FARM</td>\n",
       "      <td>2265</td>\n",
       "      <td>Monadnock Moonshine</td>\n",
       "      <td>750.0</td>\n",
       "      <td>21.47</td>\n",
       "      <td>NaN</td>\n",
       "      <td>267</td>\n",
       "      <td>5732.49</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>713.36</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10694</th>\n",
       "      <td>173357</td>\n",
       "      <td>TAMWORTH DISTILLING</td>\n",
       "      <td>2804</td>\n",
       "      <td>Camp Robber Whiskey</td>\n",
       "      <td>750.0</td>\n",
       "      <td>32.14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>210</td>\n",
       "      <td>6749.40</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>810.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10695</th>\n",
       "      <td>173357</td>\n",
       "      <td>TAMWORTH DISTILLING</td>\n",
       "      <td>3666</td>\n",
       "      <td>Art in the Age Chicory Root</td>\n",
       "      <td>375.0</td>\n",
       "      <td>18.79</td>\n",
       "      <td>NaN</td>\n",
       "      <td>520</td>\n",
       "      <td>9770.80</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>810.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10696</th>\n",
       "      <td>173357</td>\n",
       "      <td>TAMWORTH DISTILLING</td>\n",
       "      <td>3848</td>\n",
       "      <td>Chicory Root Vodka</td>\n",
       "      <td>750.0</td>\n",
       "      <td>23.30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>28</td>\n",
       "      <td>652.40</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>810.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10697</th>\n",
       "      <td>201359</td>\n",
       "      <td>FLAVOR ESSENCE INC</td>\n",
       "      <td>90609</td>\n",
       "      <td>Flavor Essence Variety 5 Pak</td>\n",
       "      <td>5.0</td>\n",
       "      <td>17.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>17.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.36</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10698 rows  19 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       VendorNumber                   VendorName  Brand  \\\n",
       "0             90037  THE PIERPONT GROUP LLC        2163   \n",
       "1              2396  BLACK PRINCE DISTILLERY INC   3079   \n",
       "2             90047  CRUSH WINES                  23218   \n",
       "3             90037  THE PIERPONT GROUP LLC        3770   \n",
       "4              2555  DISARONNO INTERNATIONAL LLC   1212   \n",
       "...             ...                          ...    ...   \n",
       "10693        172662     SWEETWATER FARM            2265   \n",
       "10694        173357  TAMWORTH DISTILLING           2804   \n",
       "10695        173357  TAMWORTH DISTILLING           3666   \n",
       "10696        173357  TAMWORTH DISTILLING           3848   \n",
       "10697        201359  FLAVOR ESSENCE INC           90609   \n",
       "\n",
       "                        Description  Volume  PurchasePrice  ActualPrice  \\\n",
       "0                      Sloane's Gin   750.0          14.38    20.598696   \n",
       "1               Devils Spring Vodka   750.0          10.21    14.098527   \n",
       "2                     Tangent Chard   750.0           6.70     9.990000   \n",
       "3               Miodula Honey Vodka   750.0          14.17    19.546962   \n",
       "4       DiSaronna Amaretto Sour VAP   750.0          14.38    21.872521   \n",
       "...                             ...     ...            ...          ...   \n",
       "10693           Monadnock Moonshine   750.0          21.47          NaN   \n",
       "10694           Camp Robber Whiskey   750.0          32.14          NaN   \n",
       "10695   Art in the Age Chicory Root   375.0          18.79          NaN   \n",
       "10696            Chicory Root Vodka   750.0          23.30          NaN   \n",
       "10697  Flavor Essence Variety 5 Pak     5.0          17.00          NaN   \n",
       "\n",
       "       TotalPurchaseQuantity  TotalPurchaseDollars  TotalSalesQuantity  \\\n",
       "0                         91               1308.58               174.0   \n",
       "1                        420               4288.20               456.0   \n",
       "2                        663               4442.10              1154.0   \n",
       "3                        142               2012.14               141.0   \n",
       "4                        563               8095.94              1467.0   \n",
       "...                      ...                   ...                 ...   \n",
       "10693                    267               5732.49                 NaN   \n",
       "10694                    210               6749.40                 NaN   \n",
       "10695                    520               9770.80                 NaN   \n",
       "10696                     28                652.40                 NaN   \n",
       "10697                      1                 17.00                 NaN   \n",
       "\n",
       "       TotalSalesDollars  TotalSalesPrice  TotalExciseTax  FreightCost  \\\n",
       "0                3553.26          2368.85          137.18       111.92   \n",
       "1                6231.44          3637.42          359.25       123.92   \n",
       "2               11528.46          5344.65          128.60      5830.92   \n",
       "3                2729.59          1544.21          111.11       111.92   \n",
       "4               32089.33         15267.02         1155.39     23444.12   \n",
       "...                  ...              ...             ...          ...   \n",
       "10693                NaN              NaN             NaN       713.36   \n",
       "10694                NaN              NaN             NaN       810.00   \n",
       "10695                NaN              NaN             NaN       810.00   \n",
       "10696                NaN              NaN             NaN       810.00   \n",
       "10697                NaN              NaN             NaN         0.36   \n",
       "\n",
       "        Profit  GrossProfit  ProfitMargin  StockTurnover  SalesToPurchaseRatio  \n",
       "0      2132.76      2244.68     63.172411       1.912088              2.715356  \n",
       "1      1819.32      1943.24     31.184445       1.085714              1.453160  \n",
       "2      1255.44      7086.36     61.468401       1.740573              2.595273  \n",
       "3       605.53       717.45     26.284167       0.992958              1.356561  \n",
       "4       549.27     23993.39     74.770617       2.605684              3.963632  \n",
       "...        ...          ...           ...            ...                   ...  \n",
       "10693      NaN          NaN           NaN            NaN                   NaN  \n",
       "10694      NaN          NaN           NaN            NaN                   NaN  \n",
       "10695      NaN          NaN           NaN            NaN                   NaN  \n",
       "10696      NaN          NaN           NaN            NaN                   NaN  \n",
       "10697      NaN          NaN           NaN            NaN                   NaN  \n",
       "\n",
       "[10698 rows x 19 columns]"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.read_sql_query(\"select * from vendor_sales_summary\",conn)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "dcaaea3d-969b-4f09-bc39-a3d8f76be015",
   "metadata": {},
   "outputs": [],
   "source": [
    "import re\n",
    "import numpy as np\n",
    "\n",
    "def convert_volume(x):\n",
    "    if pd.isna(x):\n",
    "        return np.nan\n",
    "\n",
    "    x = str(x).strip().upper()\n",
    "\n",
    "    # extract numeric value safely\n",
    "    match = re.search(r\"\\d+\\.?\\d*\", x)\n",
    "    if not match:\n",
    "        return np.nan\n",
    "\n",
    "    value = float(match.group())\n",
    "\n",
    "    if \"ML\" in x:\n",
    "        return value / 1000\n",
    "    elif \"L\" in x:\n",
    "        return value\n",
    "    else:\n",
    "        # GA, CS, EA, etc.\n",
    "        return np.nan\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "396f2375-9b77-45cf-8165-8be82c168230",
   "metadata": {},
   "outputs": [],
   "source": [
    "summary_df[\"Volume\"] = summary_df[\"Volume\"].apply(convert_volume)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "e6d11080-6a21-4470-9b6d-3904573c38c0",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'clean_df' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[31m---------------------------------------------------------------------------\u001b[39m",
      "\u001b[31mNameError\u001b[39m                                 Traceback (most recent call last)",
      "\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[49]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m \u001b[43mclean_df\u001b[49m[[\u001b[33m'\u001b[39m\u001b[33mVolume\u001b[39m\u001b[33m'\u001b[39m]].head()\n\u001b[32m      2\u001b[39m clean_df.dtypes\n",
      "\u001b[31mNameError\u001b[39m: name 'clean_df' is not defined"
     ]
    }
   ],
   "source": [
    "clean_df[['Volume']].head()\n",
    "clean_df.dtypes\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "633eac6c-54cb-4318-a687-ab563637d841",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "conn = sqlite3.connect(\"inventory.db\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "7d17818a-5d64-4f7b-bc23-01f5619e71c8",
   "metadata": {},
   "outputs": [],
   "source": [
    "summary_df = create_vendor_summary(conn)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "df81e4f7-e68d-4c30-8844-21f589e7409e",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "import logging\n",
    "import re\n",
    "import numpy as np\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "bbbbb992-e65a-4d3c-90c6-12b87cfc958b",
   "metadata": {},
   "outputs": [],
   "source": [
    "def clean_data(df):\n",
    "\n",
    "    def convert_volume(x):\n",
    "        if pd.isna(x):\n",
    "            return np.nan\n",
    "\n",
    "        x = str(x).strip().upper()\n",
    "\n",
    "        # extract numeric part safely\n",
    "        match = re.search(r\"\\d+\\.?\\d*\", x)\n",
    "        if not match:\n",
    "            return np.nan\n",
    "\n",
    "        value = float(match.group())\n",
    "\n",
    "        if \"ML\" in x:\n",
    "            return value / 1000\n",
    "        elif \"L\" in x:\n",
    "            return value\n",
    "        else:\n",
    "            # GA, CS, EA, etc.\n",
    "            return np.nan\n",
    "\n",
    "    df[\"Volume\"] = df[\"Volume\"].apply(convert_volume)\n",
    "\n",
    "    # trim text\n",
    "    df[\"VendorName\"] = df[\"VendorName\"].str.strip()\n",
    "    df[\"Description\"] = df[\"Description\"].str.strip()\n",
    "\n",
    "    df.fillna(0, inplace=True)\n",
    "\n",
    "    df[\"GrossProfit\"] = df[\"TotalSalesDollars\"] - df[\"TotalPurchaseDollars\"]\n",
    "    df[\"ProfitMargin\"] = (\n",
    "        df[\"GrossProfit\"] / df[\"TotalSalesDollars\"]\n",
    "    ).replace([float(\"inf\"), -float(\"inf\")], 0) * 100\n",
    "\n",
    "    df[\"StockTurnover\"] = (\n",
    "        df[\"TotalSalesQuantity\"] / df[\"TotalPurchaseQuantity\"]\n",
    "    ).replace([float(\"inf\"), -float(\"inf\")], 0)\n",
    "\n",
    "    df[\"SalesToPurchaseRatio\"] = (\n",
    "        df[\"TotalSalesDollars\"] / df[\"TotalPurchaseDollars\"]\n",
    "    ).replace([float(\"inf\"), -float(\"inf\")], 0)\n",
    "\n",
    "    return df\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "4b11ff7d-d3e6-4a4b-8dde-3893f2787ae0",
   "metadata": {},
   "outputs": [],
   "source": [
    "conn = sqlite3.connect(\"inventory.db\")\n",
    "\n",
    "summary_df = create_vendor_summary(conn)\n",
    "clean_df = clean_data(summary_df)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "7c1eda00-c5e0-4803-8b50-76b2a7d7977f",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "import logging\n",
    "import re\n",
    "import numpy as np\n",
    "\n",
    "# ---------------- LOGGING ----------------\n",
    "logging.basicConfig(\n",
    "    filename=\"logs/get_vendor_summary.log\",\n",
    "    level=logging.INFO,\n",
    "    format=\"%(asctime)s - %(levelname)s - %(message)s\",\n",
    "    filemode=\"a\"\n",
    ")\n",
    "\n",
    "# ---------------- DB INGEST FUNCTION ----------------\n",
    "def ingest_db(df, table_name, conn):\n",
    "    df.to_sql(table_name, conn, if_exists=\"replace\", index=False)\n",
    "\n",
    "# ---------------- CREATE SUMMARY ----------------\n",
    "def create_vendor_summary(conn):\n",
    "    query = \"\"\"\n",
    "    WITH FreightSummary AS (\n",
    "        SELECT VendorNumber, SUM(Freight) AS FreightCost\n",
    "        FROM vendor_invoice\n",
    "        GROUP BY VendorNumber\n",
    "    ),\n",
    "    PurchaseSummary AS (\n",
    "        SELECT \n",
    "            VendorNumber,\n",
    "            VendorName,\n",
    "            Brand,\n",
    "            Description,\n",
    "            Size AS Volume,\n",
    "            PurchasePrice,\n",
    "            SUM(Quantity) AS TotalPurchaseQuantity,\n",
    "            SUM(Dollars) AS TotalPurchaseDollars\n",
    "        FROM purchases\n",
    "        WHERE PurchasePrice > 0\n",
    "        GROUP BY VendorNumber, VendorName, Brand, Description, Size, PurchasePrice\n",
    "    ),\n",
    "    SalesSummary AS (\n",
    "        SELECT \n",
    "            Brand,\n",
    "            Description,\n",
    "            AVG(SalesPrice) AS ActualPrice,\n",
    "            SUM(SalesQuantity) AS TotalSalesQuantity,\n",
    "            SUM(SalesDollars) AS TotalSalesDollars,\n",
    "            SUM(SalesPrice) AS TotalSalesPrice,\n",
    "            SUM(ExciseTax) AS TotalExciseTax\n",
    "        FROM sales\n",
    "        GROUP BY Brand, Description\n",
    "    )\n",
    "    SELECT \n",
    "        ps.VendorNumber,\n",
    "        ps.VendorName,\n",
    "        ps.Brand,\n",
    "        ps.Description,\n",
    "        ps.Volume,\n",
    "        ps.PurchasePrice,\n",
    "        ss.ActualPrice,\n",
    "        ps.TotalPurchaseQuantity,\n",
    "        ps.TotalPurchaseDollars,\n",
    "        ss.TotalSalesQuantity,\n",
    "        ss.TotalSalesDollars,\n",
    "        ss.TotalSalesPrice,\n",
    "        ss.TotalExciseTax,\n",
    "        COALESCE(fs.FreightCost, 0) AS FreightCost\n",
    "    FROM PurchaseSummary ps\n",
    "    LEFT JOIN SalesSummary ss\n",
    "        ON ps.Brand = ss.Brand\n",
    "       AND ps.Description = ss.Description\n",
    "    LEFT JOIN FreightSummary fs\n",
    "        ON ps.VendorNumber = fs.VendorNumber\n",
    "    \"\"\"\n",
    "    return pd.read_sql_query(query, conn)\n",
    "\n",
    "# ---------------- CLEAN + KPI ----------------\n",
    "def clean_data(df):\n",
    "\n",
    "    #  SAFE volume conversion (NO crashes)\n",
    "    def convert_volume(x):\n",
    "        if pd.isna(x):\n",
    "            return 0.0\n",
    "\n",
    "        x = str(x).upper().strip()\n",
    "\n",
    "        # extract numeric part safely\n",
    "        match = re.search(r\"\\d+\\.?\\d*\", x)\n",
    "        if not match:\n",
    "            return 0.0\n",
    "\n",
    "        value = float(match.group())\n",
    "\n",
    "        if \"ML\" in x:\n",
    "            return value / 1000\n",
    "        elif \"L\" in x:\n",
    "            return value\n",
    "        else:\n",
    "            # GA, CS, EA, etc  ignore\n",
    "            return 0.0\n",
    "\n",
    "    df[\"Volume\"] = df[\"Volume\"].apply(convert_volume)\n",
    "\n",
    "    # Clean text columns\n",
    "    df[\"VendorName\"] = df[\"VendorName\"].str.strip()\n",
    "    df[\"Description\"] = df[\"Description\"].str.strip()\n",
    "\n",
    "    # Fill remaining nulls\n",
    "    df.fillna(0, inplace=True)\n",
    "\n",
    "    # KPIs\n",
    "    df[\"GrossProfit\"] = df[\"TotalSalesDollars\"] - df[\"TotalPurchaseDollars\"]\n",
    "\n",
    "    df[\"ProfitMargin\"] = (\n",
    "        df[\"GrossProfit\"] / df[\"TotalSalesDollars\"]\n",
    "    ).replace([np.inf, -np.inf], 0) * 100\n",
    "\n",
    "    df[\"StockTurnover\"] = (\n",
    "        df[\"TotalSalesQuantity\"] / df[\"TotalPurchaseQuantity\"]\n",
    "    ).replace([np.inf, -np.inf], 0)\n",
    "\n",
    "    df[\"SalesToPurchaseRatio\"] = (\n",
    "        df[\"TotalSalesDollars\"] / df[\"TotalPurchaseDollars\"]\n",
    "    ).replace([np.inf, -np.inf], 0)\n",
    "\n",
    "    return df\n",
    "\n",
    "# ---------------- MAIN ----------------\n",
    "if __name__ == \"__main__\":\n",
    "    conn = sqlite3.connect(\"inventory.db\")\n",
    "\n",
    "    logging.info(\"Creating vendor sales summary\")\n",
    "    summary_df = create_vendor_summary(conn)\n",
    "\n",
    "    logging.info(\"Cleaning data\")\n",
    "    clean_df = clean_data(summary_df)\n",
    "\n",
    "    logging.info(\"Ingesting vendor_sales_summary table\")\n",
    "    ingest_db(clean_df, \"vendor_sales_summary\", conn)\n",
    "\n",
    "    conn.close()\n",
    "    logging.info(\"Pipeline completed successfully\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "7cd74fcf-ed23-4bb5-bb07-30df71e2c514",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "VendorNumber               int64\n",
       "VendorName                object\n",
       "Brand                      int64\n",
       "Description               object\n",
       "Volume                   float64\n",
       "PurchasePrice            float64\n",
       "ActualPrice              float64\n",
       "TotalPurchaseQuantity      int64\n",
       "TotalPurchaseDollars     float64\n",
       "TotalSalesQuantity       float64\n",
       "TotalSalesDollars        float64\n",
       "TotalSalesPrice          float64\n",
       "TotalExciseTax           float64\n",
       "FreightCost              float64\n",
       "GrossProfit              float64\n",
       "ProfitMargin             float64\n",
       "StockTurnover            float64\n",
       "SalesToPurchaseRatio     float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "clean_df[[\"Volume\"]].head()\n",
    "clean_df.dtypes\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b555cf9e-1f57-4f2b-90e7-50ff714236de",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
